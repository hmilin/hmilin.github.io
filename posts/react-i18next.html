<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Meiling&#x27;s Blog</title><meta name="description" content="meilingçš„åšå®¢"/><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/275b2a15ad29278d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/275b2a15ad29278d.css" data-n-g=""/><link rel="preload" href="/_next/static/css/be3b6285a2614a27.css" as="style"/><link rel="stylesheet" href="/_next/static/css/be3b6285a2614a27.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-a85322f027b40e20.js" defer=""></script><script src="/_next/static/chunks/main-6c11f3d61c45c1c1.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ab4c043ec570de8c.js" defer=""></script><script src="/_next/static/chunks/196-32419b2dc902ac8d.js" defer=""></script><script src="/_next/static/chunks/927-f194a212e80173e6.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-ff83de698e35108e.js" defer=""></script><script src="/_next/static/2XlT3rGw8n9OHW1k7dVgT/_buildManifest.js" defer=""></script><script src="/_next/static/2XlT3rGw8n9OHW1k7dVgT/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="Layout_container__XDtoS"><header class="Header_header__aO32P"><div class="Header_mobileNav__x8dOm"><div class="Header_menuIcon__zsaJW"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#5f6368" viewBox="0 -960 960 960"><path d="M120-240v-80h720v80zm0-200v-80h720v80zm0-200v-80h720v80z"></path></svg></div><a class="Header_searchBtn__DiCC5" href="/search"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#5f6368" viewBox="0 -960 960 960"><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580t75.5-184.5T380-840t184.5 75.5T640-580q0 44-14 83t-38 69l252 252zM380-400q75 0 127.5-52.5T560-580t-52.5-127.5T380-760t-127.5 52.5T200-580t52.5 127.5T380-400"></path></svg></a></div><nav class="Header_nav__wk8Zc"><div class="Header_closeIcon__TBNuf"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#5f6368" viewBox="0 -960 960 960"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224z"></path></svg></div><a class="Header_searchBtn__DiCC5" href="/search"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#5f6368" viewBox="0 -960 960 960"><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580t75.5-184.5T380-840t184.5 75.5T640-580q0 44-14 83t-38 69l252 252zM380-400q75 0 127.5-52.5T560-580t-52.5-127.5T380-760t-127.5 52.5T200-580t52.5 127.5T380-400"></path></svg></a><a class="" href="/"><div class="Header_icon__SYetk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#5f6368" viewBox="0 -960 960 960"><path d="M200-160v-366L88-440l-48-64 440-336 160 122v-82h120v174l160 122-48 64-112-86v366H520v-240h-80v240zm80-80h80v-240h240v240h80v-347L480-739 280-587zm120-319h160q0-32-24-52.5T480-632t-56 20.5-24 52.5m-40 319v-240h240v240-240H360z"></path></svg></div><div class="Header_title__BTC6R">é¦–é¡µ</div></a><a class="" href="/category/native"><div class="Header_icon__SYetk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#5f6368" viewBox="0 -960 960 960"><path d="M200-640v440h560v-440H640v320l-160-80-160 80v-320zm0 520q-33 0-56.5-23.5T120-200v-499q0-14 4.5-27t13.5-24l50-61q11-14 27.5-21.5T250-840h460q18 0 34.5 7.5T772-811l50 61q9 11 13.5 24t4.5 27v499q0 33-23.5 56.5T760-120zm16-600h528l-34-40H250zm184 80v190l80-40 80 40v-190zm-200 0h560z"></path></svg></div><div class="Header_title__BTC6R">åŸç”ŸåŸºç¡€</div></a><a class="" href="/category/framework"><div class="Header_icon__SYetk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#5f6368" viewBox="0 -960 960 960"><path d="M400-400h160v-80H400zm0-120h320v-80H400zm0-120h320v-80H400zm-80 400q-33 0-56.5-23.5T240-320v-480q0-33 23.5-56.5T320-880h480q33 0 56.5 23.5T880-800v480q0 33-23.5 56.5T800-240zm0-80h480v-480H320zM160-80q-33 0-56.5-23.5T80-160v-560h80v560h560v80zm160-720v480z"></path></svg></div><div class="Header_title__BTC6R">æ¡†æ¶ç›¸å…³</div></a><a class="" href="/category/tool"><div class="Header_icon__SYetk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#5f6368" viewBox="0 -960 960 960"><path d="m620-284 56-56q6-6 6-14t-6-14L540-505q4-11 6-22t2-25q0-57-40.5-97.5T410-690q-17 0-34 4.5T343-673l94 94-56 56-94-94q-8 16-12.5 33t-4.5 34q0 57 40.5 97.5T408-412q13 0 24.5-2t22.5-6l137 136q6 6 14 6t14-6M480-80q-83 0-156-31.5T197-197t-85.5-127T80-480t31.5-156T197-763t127-85.5T480-880t156 31.5T763-763t85.5 127T880-480t-31.5 156T763-197t-127 85.5T480-80m0-80q134 0 227-93t93-227-93-227-227-93-227 93-93 227 93 227 227 93m0-320"></path></svg></div><div class="Header_title__BTC6R">å·¥å…·ä½¿ç”¨</div></a><a class="" href="/about"><div class="Header_icon__SYetk"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="#5f6368" viewBox="0 -960 960 960"><path d="M360-390q-21 0-35.5-14.5T310-440t14.5-35.5T360-490t35.5 14.5T410-440t-14.5 35.5T360-390m240 0q-21 0-35.5-14.5T550-440t14.5-35.5T600-490t35.5 14.5T650-440t-14.5 35.5T600-390M480-160q134 0 227-93t93-227q0-24-3-46.5T786-570q-21 5-42 7.5t-44 2.5q-91 0-172-39T390-708q-32 78-91.5 135.5T160-486v6q0 134 93 227t227 93m0 80q-83 0-156-31.5T197-197t-85.5-127T80-480t31.5-156T197-763t127-85.5T480-880t156 31.5T763-763t85.5 127T880-480t-31.5 156T763-197t-127 85.5T480-80m-54-715q42 70 114 112.5T700-640q14 0 27-1.5t27-3.5q-42-70-114-112.5T480-800q-14 0-27 1.5t-27 3.5M177-581q51-29 89-75t57-103q-51 29-89 75t-57 103m146-178"></path></svg></div><div class="Header_title__BTC6R">å…³äº</div></a></nav></header><div><main><div class="Layout_cover__vC5GW"><div><h1>ä½¿ç”¨react-i18nextè¿›è¡Œå›½é™…åŒ–é…ç½®</h1><p>åœ¨reactçš„åº”ç”¨ä¸­å¦‚ä½•è¿›è¡Œå›½é™…åŒ–é…ç½®ï¼Œå¹¶é€‚é…å¤šç§ä½¿ç”¨åœºæ™¯ä»¥åŠå¼€å‘ä½“éªŒçš„æå‡</p><div>2024-07-25 19:03:00</div></div></div><div class="content-container"><h1>ä½¿ç”¨react-i18nextè¿›è¡Œå›½é™…åŒ–é…ç½®</h1>
<p>æœ¬æ–‡è®°å½•äº†å¦‚ä½•<code>react-i18next</code>çš„åŸºç¡€é…ç½®ã€è·Ÿtypescriptçš„ç»“åˆä½¿ç”¨ã€åœ¨ç»„ä»¶å†…å¤–çš„ä½¿ç”¨å’Œå¦‚ä½•é€šè¿‡è‡ªå®šä¹‰è„šæœ¬æ¥æé«˜ç¿»è¯‘æ–‡æœ¬è¾“å‡ºã€‚</p>
<h2>åŸºç¡€ä½¿ç”¨</h2>
<ol>
<li>å®‰è£… <code>i18next</code> å’Œ <code>react-i18next</code></li>
<li>åœ¨<code>src</code>ç›®å½•ä¸‹åˆ›å»º<code>i18n.ts</code>æ–‡ä»¶ï¼Œå¹¶åˆ›å»º<code>locales</code>ç›®å½•æ¥å­˜æ”¾ä¸åŒè¯­è¨€å¯¹åº”çš„ç¿»è¯‘</li>
</ol>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> { setValidateLanguage } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;@formily/core&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> i18n </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;i18next&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> { initReactI18next } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;react-i18next&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> en </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;./locales/en/translation.json&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> zh </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;./locales/zh/translation.json&#x27;</span><span>;
</span>
<span></span><span style="color:#b48ead">const</span><span> defaultLg = </span><span style="color:#d08770">localStorage</span><span>.getItem(</span><span style="color:#a3be8c">&#x27;locale&#x27;</span><span>) || </span><span style="color:#a3be8c">&#x27;zh-CN&#x27;</span><span>;
</span>i18n.use(initReactI18next).init({
<span>  </span><span class="hljs-attr">fallbackLng</span><span>: defaultLg,
</span><span>  </span><span class="hljs-attr">debug</span><span>: </span><span style="color:#d08770">true</span><span>,
</span><span>  </span><span class="hljs-attr">interpolation</span><span>: {
</span><span>    </span><span class="hljs-attr">escapeValue</span><span>: </span><span style="color:#d08770">false</span><span>, </span><span style="color:#65737e">// not needed for react as it escapes by default</span><span>
</span>  },
<span>  </span><span class="hljs-attr">resources</span><span>: {
</span><span>    </span><span style="color:#a3be8c">&#x27;en-US&#x27;</span><span>: {
</span><span>      </span><span class="hljs-attr">translation</span><span>: en,
</span>    },
<span>    </span><span style="color:#a3be8c">&#x27;zh-CN&#x27;</span><span>: {
</span><span>      </span><span class="hljs-attr">translation</span><span>: zh,
</span>    },
<!-- -->  },
<!-- -->});
<!-- -->
<span></span><span style="color:#b48ead">export</span><span> </span><span style="color:#b48ead">default</span><span> i18n;
</span></code></pre>
<p>å¹¶åœ¨<code>App.tsx</code>ä¸­å¯¼å…¥</p>
<ol start="3">
<li>å®šä¹‰è¯­è¨€åˆ‡æ¢ç»„ä»¶ï¼Œé€šè¿‡è°ƒç”¨<code>i18n</code>å®ä¾‹ä¸‹çš„<code>changeLanguage</code>æ–¹æ³•æ¥åˆ‡æ¢è¯­è¨€ï¼Œå¹¶ä½¿ç”¨<code>localStorage</code>æ¥æŒä¹…åŒ–æ•°æ®</li>
</ol>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> { TranslationOutlined } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;@ant-design/icons&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> { Dropdown } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;antd&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> { useTranslation } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;react-i18next&#x27;</span><span>;
</span>
<span></span><span style="color:#b48ead">const</span><span> items = [
</span>  {
<span>    </span><span class="hljs-attr">key</span><span>: </span><span style="color:#a3be8c">&#x27;en-US&#x27;</span><span>,
</span><span>    </span><span class="hljs-attr">label</span><span>: </span><span style="color:#a3be8c">&#x27;English&#x27;</span><span>,
</span>  },
<!-- -->  {
<span>    </span><span class="hljs-attr">key</span><span>: </span><span style="color:#a3be8c">&#x27;zh-CN&#x27;</span><span>,
</span><span>    </span><span class="hljs-attr">label</span><span>: </span><span style="color:#a3be8c">&#x27;ä¸­æ–‡&#x27;</span><span>,
</span>  },
<!-- -->];
<!-- -->
<span></span><span style="color:#b48ead">interface</span><span> LanguageChangerProps {}
</span>
<span></span><span style="color:#b48ead">const</span><span> LanguageChanger: React.FC&lt;LanguageChangerProps&gt; = </span><span class="hljs-function">() =&gt;</span><span> {
</span><span>  </span><span style="color:#b48ead">const</span><span> { i18n } = useTranslation();
</span>
<span>  </span><span style="color:#b48ead">const</span><span> handleChange = </span><span class="hljs-function">(</span><span class="hljs-function" style="color:#d08770">key: </span><span class="hljs-function" style="color:#d08770">string</span><span class="hljs-function">) =&gt;</span><span> {
</span>    i18n.changeLanguage(key);
<span>    </span><span style="color:#d08770">localStorage</span><span>.setItem(</span><span style="color:#a3be8c">&#x27;locale&#x27;</span><span>, key);
</span>  };
<!-- -->
<span>  </span><span style="color:#b48ead">return</span><span> (
</span><span>    </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">Dropdown</span><span class="xml" style="color:#bf616a">
</span><span class="xml" style="color:#bf616a">      </span><span class="xml hljs-attr" style="color:#bf616a">menu</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">{{</span><span class="xml" style="color:#bf616a">
</span><span class="xml" style="color:#bf616a">        </span><span class="xml hljs-attr" style="color:#bf616a">items</span><span class="xml" style="color:#bf616a">,
</span><span class="xml" style="color:#bf616a">        </span><span class="xml hljs-attr" style="color:#bf616a">selectedKeys:</span><span class="xml" style="color:#bf616a"> [</span><span class="xml hljs-attr" style="color:#bf616a">i18n.language</span><span class="xml" style="color:#bf616a">],
</span><span class="xml" style="color:#bf616a">        </span><span class="xml hljs-attr" style="color:#bf616a">onClick:</span><span class="xml" style="color:#bf616a"> ({ </span><span class="xml hljs-attr" style="color:#bf616a">key</span><span class="xml" style="color:#bf616a"> }) =&gt;</span><span class="xml"> handleChange(key),
</span><span class="xml">      }}
</span><span class="xml">    &gt;
</span><span class="xml">      </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">div</span><span class="xml" style="color:#bf616a"> </span><span class="xml hljs-attr" style="color:#bf616a">className</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">&quot;header-item&quot;</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">        </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">TranslationOutlined</span><span class="xml" style="color:#bf616a"> /&gt;</span><span class="xml">
</span><span class="xml">      </span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">div</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">    </span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">Dropdown</span><span class="xml" style="color:#bf616a">&gt;</span><span>
</span>  );
<!-- -->};
<!-- -->
<span></span><span style="color:#b48ead">export</span><span> </span><span style="color:#b48ead">default</span><span> LanguageChanger;
</span>
</code></pre>
<ol start="4">
<li>é€šè¿‡translationæ–‡ä»¶ä¸­å¯¹åº”çš„keyæ¥ä½¿ç”¨ï¼Œè€ƒè™‘åˆ°éšç€ä¸šåŠ¡çš„æ–°å¢ç¿»è¯‘é…ç½®ä¼šè¶Šæ¥è¶Šå¤šï¼Œæå‰å°†é…ç½®è¿›è¡Œåˆ†ç»„</li>
</ol>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span>{
</span><span>  </span><span style="color:#65737e">// å…¨å±€å…¬å…±é…ç½®</span><span>
</span><span>  </span><span class="hljs-attr">&quot;global&quot;</span><span>: {
</span><span>     </span><span style="color:#65737e">// é¡µé¢å¯¼èˆª</span><span>
</span><span>    </span><span class="hljs-attr">&quot;pages&quot;</span><span>: {},
</span><span>    </span><span style="color:#65737e">// åŸºç¡€å…¬å…±é…ç½®</span><span>
</span><span>    </span><span class="hljs-attr">&quot;common&quot;</span><span>: {
</span><span>      </span><span class="hljs-attr">&quot;confirmTitle&quot;</span><span>: </span><span style="color:#a3be8c">&quot;ç¡®è®¤&quot;</span><span>
</span>    },
<span>    </span><span style="color:#65737e">// æ¨¡æ¿</span><span>
</span><span>    </span><span class="hljs-attr">&quot;templates&quot;</span><span>: {
</span><span>      </span><span class="hljs-attr">&quot;remove_confirm&quot;</span><span>: </span><span style="color:#a3be8c">&quot;ç¡®å®šåˆ é™¤{{target}} &lt;strong&gt;{{name}}&lt;/strong&gt;ï¼Ÿ&quot;</span><span>
</span>    },
<span>    </span><span style="color:#65737e">// æç¤ºè¯­</span><span>
</span><span>    </span><span class="hljs-attr">&quot;messages&quot;</span><span>: {
</span><span>      </span><span class="hljs-attr">&quot;remove_successful&quot;</span><span>: </span><span style="color:#a3be8c">&quot;åˆ é™¤æˆåŠŸï¼&quot;</span><span>,
</span><span>      </span><span class="hljs-attr">&quot;save_successful&quot;</span><span>: </span><span style="color:#a3be8c">&quot;ä¿å­˜æˆåŠŸï¼&quot;</span><span>
</span>    }
<!-- -->  },
<span>  </span><span style="color:#65737e">//æ ¹æ®ä¸šåŠ¡å¯¹è±¡è¿›è¡Œåˆ†ç±»</span><span>
</span><span>  </span><span class="hljs-attr">&quot;users&quot;</span><span>: {},
</span><span>  </span><span class="hljs-attr">&quot;projects&quot;</span><span>: {},
</span>}
</code></pre>
<h2>Typescripté…ç½®å®ç°æç¤º</h2>
<p>ç»è¿‡ä»¥ä¸Šé…ç½®åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸Šé¢é…ç½®çš„keyæ¥ä½¿ç”¨å›½é™…åŒ–æ–‡æœ¬ï¼Œæ¯”å¦‚åœ¨ç»„ä»¶ä¸­è°ƒç”¨<code>useTranslation</code>APIè¿”å›çš„tæ–¹æ³•æ¥è·å–æ–‡æœ¬</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span> </span><span style="color:#b48ead">const</span><span> { t } = useTranslation();
</span><span> </span><span style="color:#b48ead">return</span><span> t(</span><span style="color:#a3be8c">&#x27;global.common.hello&#x27;</span><span>)
</span></code></pre>
<p><code>react-i18next</code>æ”¯æŒé€šè¿‡tsçš„ç±»å‹é…ç½®æ¥å®ç°æç¤º</p>
<ol>
<li>åœ¨src/@typesä¸‹ç›®å½•ä¸‹å»ºç«‹resources.tsï¼Œå¯¼å…¥ä¸»è¯­è¨€çš„é…ç½®</li>
</ol>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> translation </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;../locales/zh/translation.json&#x27;</span><span>;
</span>
<span></span><span style="color:#b48ead">const</span><span> resources = {
</span>  translation,
<span>} </span><span style="color:#b48ead">as</span><span> </span><span style="color:#b48ead">const</span><span>;
</span>
<span></span><span style="color:#b48ead">export</span><span> </span><span style="color:#b48ead">default</span><span> resources;
</span></code></pre>
<ol start="2">
<li>åœ¨src/@typesä¸‹ç›®å½•ä¸‹å»ºç«‹i18next.d.tsï¼Œå¹¶æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š</li>
</ol>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> resources </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;./resources&#x27;</span><span>;
</span>
<span>declare </span><span style="color:#d08770">module</span><span> </span><span style="color:#a3be8c">&#x27;i18next&#x27;</span><span> {
</span>  interface CustomTypeOptions {
<span>    </span><span class="hljs-attr">resources</span><span>: </span><span style="color:#b48ead">typeof</span><span> resources;
</span>  }
<!-- -->}
</code></pre>
<p>å†æ¬¡è°ƒç”¨tæ–¹æ³•æ—¶ï¼Œå°±èƒ½çœ‹è§ç±»å‹çš„æç¤ºäº†ã€‚</p>
<h2>åœ¨å¤šç§åœºæ™¯ä¸‹çš„ä½¿ç”¨æ–¹å¼</h2>
<ol>
<li>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨</li>
</ol>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">const</span><span> { t } = useTranslation();
</span><span>t(</span><span style="color:#a3be8c">&#x27;global.common.hello&#x27;</span><span>)
</span></code></pre>
<ol start="2">
<li>åœ¨ç»„ä»¶å¤–ä½¿ç”¨</li>
</ol>
<p>åœ¨ç»„ä»¶ä½œç”¨åŸŸå¤–çš„æ–‡æœ¬ï¼Œå¯ä»¥è°ƒç”¨Translationç»„ä»¶æ¥ä½¿ç”¨ï¼Œä¸ºäº†æ–¹ä¾¿è°ƒç”¨å¯ä»¥å°è£…ä»¥ä¸‹ç»„ä»¶</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> </span><span style="color:#b48ead">type</span><span> { KeyPrefix } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;i18next&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> { Translation </span><span style="color:#b48ead">as</span><span> TranslationBase } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;react-i18next&#x27;</span><span>;
</span>
<span></span><span style="color:#b48ead">type</span><span> Keys = KeyPrefix&lt;</span><span style="color:#a3be8c">&#x27;translation&#x27;</span><span>&gt;;
</span>
<span></span><span style="color:#b48ead">interface</span><span> TranslationProps {
</span><span>  </span><span class="hljs-attr">token</span><span>: Keys;
</span>}
<!-- -->
<span></span><span style="color:#b48ead">const</span><span> Translation: React.FC&lt;TranslationProps&gt; = </span><span class="hljs-function">(</span><span class="hljs-function" style="color:#d08770">{ token }</span><span class="hljs-function">) =&gt;</span><span> {
</span><span>  </span><span style="color:#b48ead">return</span><span> </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">TranslationBase</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">{(t) =&gt; t(token as unknown as any)}</span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">TranslationBase</span><span class="xml" style="color:#bf616a">&gt;</span><span>;
</span>};
<!-- -->
<span></span><span style="color:#b48ead">export</span><span> </span><span style="color:#b48ead">default</span><span> Translation;
</span>
</code></pre>
<p>ä½¿ç”¨å¦‚ä¸‹ï¼š</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">const</span><span> orderOptions = [
</span>  {
<span>    </span><span class="hljs-attr">label</span><span>: </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">Translation</span><span class="xml" style="color:#bf616a"> </span><span class="xml hljs-attr" style="color:#bf616a">token</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">&quot;global.common.updateTime&quot;</span><span class="xml" style="color:#bf616a"> /&gt;</span><span>,
</span><span>    value: </span><span style="color:#a3be8c">&#x27;modify_time&#x27;</span><span>,
</span>  },
<!-- -->  {
<span>    </span><span class="hljs-attr">label</span><span>: </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">Translation</span><span class="xml" style="color:#bf616a"> </span><span class="xml hljs-attr" style="color:#bf616a">token</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">&quot;global.common.createTime&quot;</span><span class="xml" style="color:#bf616a"> /&gt;</span><span>,
</span><span>    value: </span><span style="color:#a3be8c">&#x27;create_time&#x27;</span><span>,
</span>  },
<!-- -->];
</code></pre>
<ol start="3">
<li>ç»“åˆæ¨¡æ¿ä½¿ç”¨Tranç»„ä»¶</li>
</ol>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span>&lt;Trans i18nKey=</span><span style="color:#a3be8c">&quot;global.template.remove_confirm&quot;</span><span>&gt;
</span><span>  {{ </span><span class="hljs-attr">target</span><span>: t(</span><span style="color:#a3be8c">&#x27;applications.title&#x27;</span><span>) }}
</span><span>  {{ </span><span class="hljs-attr">name</span><span>: card.k8sName }}
</span>&lt;/Trans&gt;
</code></pre>
<h2>ç»“åˆ<code>googleç¿»è¯‘</code>å®ç°è‡ªåŠ¨åŒ–ç¿»è¯‘è„šæœ¬</h2>
<p>ç”±äºä¸€äº›å¤æ‚çš„ç¿»è¯‘éœ€è¦ç”¨åˆ°ç¿»è¯‘è½¯ä»¶è¾…åŠ©ï¼Œä½†ç¿»è¯‘è¿‡åä»éœ€äººå·¥è°ƒæ•´ï¼Œä¸€äº›è¯æ€§å·®å¼‚å’Œä¸“æœ‰åè¯ç¿»è¯‘è½¯ä»¶å¹¶ä¸èƒ½å®Œå…¨å‡†ç¡®ç¿»è¯‘ï¼Œå› æ­¤æœ€é€‚åˆçš„è‡ªåŠ¨åŒ–æ–¹æ³•æ˜¯ç¼–å†™ä¸€ä¸ªè„šæœ¬å°†æœªç¿»è¯‘çš„å­—æ®µç¿»è¯‘å¹¶å¡«å†™åˆ°å¯¹åº”æ–‡ä»¶ä¸­ï¼Œå†è¿›è¡Œäººå·¥ä¿®æ­£</p>
<p>å®‰è£…<code>@vitalets/google-translate-api</code>æ’ä»¶ï¼Œé€šè¿‡æ’ä»¶æ¥è°ƒç”¨googleç¿»è¯‘çš„API</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> { translate } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;@vitalets/google-translate-api&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> fs </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;fs&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> { HttpProxyAgent } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;http-proxy-agent&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> zhText </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;../locales/zh/translation.json&#x27;</span><span> assert  { </span><span class="hljs-attr">type</span><span>: </span><span style="color:#a3be8c">&quot;json&quot;</span><span> };
</span><span></span><span style="color:#b48ead">import</span><span> enText </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;../locales/en/translation.json&#x27;</span><span> assert  { </span><span class="hljs-attr">type</span><span>: </span><span style="color:#a3be8c">&quot;json&quot;</span><span> };
</span><span></span><span style="color:#b48ead">import</span><span> { get } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;lodash-es&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> { set } </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;lodash-es&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">import</span><span> path </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;path&#x27;</span><span>;
</span>
<span></span><span style="color:#b48ead">const</span><span> enFilePath = path.resolve(</span><span style="color:#a3be8c">&#x27;./src/locales/en/translation.json&#x27;</span><span>);
</span>
<span></span><span style="color:#b48ead">const</span><span> args = process.argv.slice(</span><span style="color:#d08770">2</span><span>);
</span><span></span><span style="color:#b48ead">const</span><span> proxy = args[</span><span style="color:#d08770">0</span><span>]?.match(</span><span style="color:#bf616a">/(?&lt;=proxy=).*/</span><span>)[</span><span style="color:#d08770">0</span><span>] || </span><span style="color:#a3be8c">&#x27;http://127.0.0.1:7890&#x27;</span><span>;
</span><span></span><span style="color:#b48ead">const</span><span> timeoutMs = </span><span style="color:#d08770">5000</span><span>;
</span>
<span></span><span style="color:#b48ead">async</span><span> </span><span class="hljs-function" style="color:#b48ead">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#8fa1b3">translateText</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#d08770">sourceText, to</span><span class="hljs-function">) </span><span>{
</span><span>  </span><span style="color:#b48ead">const</span><span> ac = </span><span style="color:#b48ead">new</span><span> AbortController();
</span><span>  </span><span style="color:#b48ead">const</span><span> timer = </span><span style="color:#d08770">setTimeout</span><span>(</span><span class="hljs-function">() =&gt;</span><span> ac.abort(), timeoutMs);
</span><span>  </span><span style="color:#b48ead">const</span><span> fetchOptions = {
</span><span>    </span><span class="hljs-attr">agent</span><span>: </span><span style="color:#b48ead">new</span><span> HttpProxyAgent(proxy),
</span><span>    </span><span class="hljs-attr">signal</span><span>: ac.signal,
</span>  };
<span>  </span><span style="color:#b48ead">try</span><span> {
</span><span>    </span><span style="color:#b48ead">const</span><span> { text } = </span><span style="color:#b48ead">await</span><span> translate(sourceText, { fetchOptions, to, });
</span><span>    </span><span style="color:#b48ead">return</span><span> text
</span><span>  } </span><span style="color:#b48ead">finally</span><span> {
</span><span>    </span><span style="color:#d08770">clearTimeout</span><span>(timer);
</span>  }
<!-- -->}
<!-- -->
<span></span><span style="color:#b48ead">async</span><span> </span><span class="hljs-function" style="color:#b48ead">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#8fa1b3">traverseTexts</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#d08770">translations, key = </span><span class="hljs-function" style="color:#a3be8c">&#x27;&#x27;</span><span class="hljs-function">) </span><span>{
</span><span>  </span><span style="color:#b48ead">for</span><span> (</span><span style="color:#b48ead">const</span><span> k </span><span style="color:#b48ead">in</span><span> translations) {
</span><span>    </span><span style="color:#b48ead">const</span><span> value = translations[k]
</span><span>    </span><span style="color:#b48ead">const</span><span> fullKey = </span><span style="color:#a3be8c">`</span><span class="hljs-subst" style="color:#a3be8c">${key ? </span><span class="hljs-subst" style="color:#a3be8c">`</span><span class="hljs-subst" style="color:#a3be8c">${key}</span><span class="hljs-subst" style="color:#a3be8c">.`</span><span class="hljs-subst" style="color:#a3be8c"> : </span><span class="hljs-subst" style="color:#a3be8c">&#x27;&#x27;</span><span class="hljs-subst" style="color:#a3be8c">}</span><span class="hljs-subst" style="color:#a3be8c">${k}</span><span style="color:#a3be8c">`</span><span>
</span><span>    </span><span style="color:#b48ead">if</span><span> (</span><span style="color:#b48ead">typeof</span><span> value === </span><span style="color:#a3be8c">&#x27;string&#x27;</span><span>) {
</span><span>      </span><span style="color:#65737e">// åªç¿»è¯‘æ–°å¢çš„é…ç½®</span><span>
</span><span>      </span><span style="color:#b48ead">if</span><span> (get(enText, fullKey) !== </span><span style="color:#b48ead">void</span><span> </span><span style="color:#d08770">0</span><span>) {
</span><span>        </span><span style="color:#b48ead">continue</span><span>
</span>      }
<span>      </span><span style="color:#d08770">console</span><span>.log(</span><span style="color:#a3be8c">&#x27;translating:&#x27;</span><span>, value)
</span><span>      </span><span style="color:#b48ead">const</span><span> translated = </span><span style="color:#b48ead">await</span><span> translateText(value, </span><span style="color:#a3be8c">&#x27;en&#x27;</span><span>)
</span>      set(enText, fullKey, translated)
<span>    } </span><span style="color:#b48ead">else</span><span> {
</span><span>      </span><span style="color:#b48ead">await</span><span> traverseTexts(value, fullKey)
</span>    }
<!-- -->  }
<!-- -->}
<!-- -->
<span></span><span class="hljs-function" style="color:#b48ead">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#8fa1b3">saveEnTexts</span><span class="hljs-function">(</span><span class="hljs-function">) </span><span>{
</span><span>  </span><span style="color:#b48ead">const</span><span> jsonContent = </span><span style="color:#d08770">JSON</span><span>.stringify(enText, </span><span style="color:#d08770">null</span><span>, </span><span style="color:#d08770">2</span><span>);
</span><span>  fs.writeFileSync(enFilePath, jsonContent, </span><span style="color:#a3be8c">&#x27;utf8&#x27;</span><span>);
</span><span>  </span><span style="color:#d08770">console</span><span>.log(</span><span style="color:#a3be8c">&#x27;Translation completed and saved to locales/en/translation.json&#x27;</span><span>);
</span>}
<!-- -->
<span></span><span style="color:#b48ead">await</span><span> traverseTexts(zhText)
</span>saveEnTexts()
</code></pre>
<p>åœ¨<code>package.json</code>ä¸­æ·»åŠ script<code>&quot;auto-translate&quot;: &quot;node ./src/locales/translate.js&quot;</code></p>
<p>åœ¨æ‰¹é‡æ–°å¢ä¸­æ–‡æ–‡æœ¬ä¹‹åï¼Œæ‰§è¡Œ<code>npm run auto-translate</code>å³å¯è‡ªåŠ¨å¡«è¡¥ç¼ºæ¼çš„è‹±æ–‡é…ç½®ï¼Œå¯é€šè¿‡<code>--proxy=</code>æ¥æŒ‡å®šæœ¬åœ°ä»£ç†åœ°å€ã€‚</p></div><div class="content-container"></div></main><footer class="grid place-items-center pb-4"><a href="https://github.com/hmilin" target="_blank" rel="noreferrer noopener">ğŸ˜˜Github</a></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    p: \"p\",\n    code: \"code\",\n    h2: \"h2\",\n    ol: \"ol\",\n    li: \"li\",\n    pre: \"pre\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.h1, {\n      children: \"ä½¿ç”¨react-i18nextè¿›è¡Œå›½é™…åŒ–é…ç½®\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"æœ¬æ–‡è®°å½•äº†å¦‚ä½•\", _jsx(_components.code, {\n        children: \"react-i18next\"\n      }), \"çš„åŸºç¡€é…ç½®ã€è·Ÿtypescriptçš„ç»“åˆä½¿ç”¨ã€åœ¨ç»„ä»¶å†…å¤–çš„ä½¿ç”¨å’Œå¦‚ä½•é€šè¿‡è‡ªå®šä¹‰è„šæœ¬æ¥æé«˜ç¿»è¯‘æ–‡æœ¬è¾“å‡ºã€‚\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"åŸºç¡€ä½¿ç”¨\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"å®‰è£… \", _jsx(_components.code, {\n          children: \"i18next\"\n        }), \" å’Œ \", _jsx(_components.code, {\n          children: \"react-i18next\"\n        })]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"åœ¨\", _jsx(_components.code, {\n          children: \"src\"\n        }), \"ç›®å½•ä¸‹åˆ›å»º\", _jsx(_components.code, {\n          children: \"i18n.ts\"\n        }), \"æ–‡ä»¶ï¼Œå¹¶åˆ›å»º\", _jsx(_components.code, {\n          children: \"locales\"\n        }), \"ç›®å½•æ¥å­˜æ”¾ä¸åŒè¯­è¨€å¯¹åº”çš„ç¿»è¯‘\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-typescript\",\n        children: \"import { setValidateLanguage } from '@formily/core';\\nimport i18n from 'i18next';\\nimport { initReactI18next } from 'react-i18next';\\nimport en from './locales/en/translation.json';\\nimport zh from './locales/zh/translation.json';\\n\\nconst defaultLg = localStorage.getItem('locale') || 'zh-CN';\\ni18n.use(initReactI18next).init({\\n  fallbackLng: defaultLg,\\n  debug: true,\\n  interpolation: {\\n    escapeValue: false, // not needed for react as it escapes by default\\n  },\\n  resources: {\\n    'en-US': {\\n      translation: en,\\n    },\\n    'zh-CN': {\\n      translation: zh,\\n    },\\n  },\\n});\\n\\nexport default i18n;\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"å¹¶åœ¨\", _jsx(_components.code, {\n        children: \"App.tsx\"\n      }), \"ä¸­å¯¼å…¥\"]\n    }), \"\\n\", _jsxs(_components.ol, {\n      start: \"3\",\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"å®šä¹‰è¯­è¨€åˆ‡æ¢ç»„ä»¶ï¼Œé€šè¿‡è°ƒç”¨\", _jsx(_components.code, {\n          children: \"i18n\"\n        }), \"å®ä¾‹ä¸‹çš„\", _jsx(_components.code, {\n          children: \"changeLanguage\"\n        }), \"æ–¹æ³•æ¥åˆ‡æ¢è¯­è¨€ï¼Œå¹¶ä½¿ç”¨\", _jsx(_components.code, {\n          children: \"localStorage\"\n        }), \"æ¥æŒä¹…åŒ–æ•°æ®\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-typescript\",\n        children: \"import { TranslationOutlined } from '@ant-design/icons';\\nimport { Dropdown } from 'antd';\\nimport { useTranslation } from 'react-i18next';\\n\\nconst items = [\\n  {\\n    key: 'en-US',\\n    label: 'English',\\n  },\\n  {\\n    key: 'zh-CN',\\n    label: 'ä¸­æ–‡',\\n  },\\n];\\n\\ninterface LanguageChangerProps {}\\n\\nconst LanguageChanger: React.FC\u003cLanguageChangerProps\u003e = () =\u003e {\\n  const { i18n } = useTranslation();\\n\\n  const handleChange = (key: string) =\u003e {\\n    i18n.changeLanguage(key);\\n    localStorage.setItem('locale', key);\\n  };\\n\\n  return (\\n    \u003cDropdown\\n      menu={{\\n        items,\\n        selectedKeys: [i18n.language],\\n        onClick: ({ key }) =\u003e handleChange(key),\\n      }}\\n    \u003e\\n      \u003cdiv className=\\\"header-item\\\"\u003e\\n        \u003cTranslationOutlined /\u003e\\n      \u003c/div\u003e\\n    \u003c/Dropdown\u003e\\n  );\\n};\\n\\nexport default LanguageChanger;\\n\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.ol, {\n      start: \"4\",\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"é€šè¿‡translationæ–‡ä»¶ä¸­å¯¹åº”çš„keyæ¥ä½¿ç”¨ï¼Œè€ƒè™‘åˆ°éšç€ä¸šåŠ¡çš„æ–°å¢ç¿»è¯‘é…ç½®ä¼šè¶Šæ¥è¶Šå¤šï¼Œæå‰å°†é…ç½®è¿›è¡Œåˆ†ç»„\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-json\",\n        children: \"{\\n  // å…¨å±€å…¬å…±é…ç½®\\n  \\\"global\\\": {\\n     // é¡µé¢å¯¼èˆª\\n    \\\"pages\\\": {},\\n    // åŸºç¡€å…¬å…±é…ç½®\\n    \\\"common\\\": {\\n      \\\"confirmTitle\\\": \\\"ç¡®è®¤\\\"\\n    },\\n    // æ¨¡æ¿\\n    \\\"templates\\\": {\\n      \\\"remove_confirm\\\": \\\"ç¡®å®šåˆ é™¤{{target}} \u003cstrong\u003e{{name}}\u003c/strong\u003eï¼Ÿ\\\"\\n    },\\n    // æç¤ºè¯­\\n    \\\"messages\\\": {\\n      \\\"remove_successful\\\": \\\"åˆ é™¤æˆåŠŸï¼\\\",\\n      \\\"save_successful\\\": \\\"ä¿å­˜æˆåŠŸï¼\\\"\\n    }\\n  },\\n  //æ ¹æ®ä¸šåŠ¡å¯¹è±¡è¿›è¡Œåˆ†ç±»\\n  \\\"users\\\": {},\\n  \\\"projects\\\": {},\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Typescripté…ç½®å®ç°æç¤º\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"ç»è¿‡ä»¥ä¸Šé…ç½®åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸Šé¢é…ç½®çš„keyæ¥ä½¿ç”¨å›½é™…åŒ–æ–‡æœ¬ï¼Œæ¯”å¦‚åœ¨ç»„ä»¶ä¸­è°ƒç”¨\", _jsx(_components.code, {\n        children: \"useTranslation\"\n      }), \"APIè¿”å›çš„tæ–¹æ³•æ¥è·å–æ–‡æœ¬\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-typescript\",\n        children: \" const { t } = useTranslation();\\n return t('global.common.hello')\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.code, {\n        children: \"react-i18next\"\n      }), \"æ”¯æŒé€šè¿‡tsçš„ç±»å‹é…ç½®æ¥å®ç°æç¤º\"]\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"åœ¨src/@typesä¸‹ç›®å½•ä¸‹å»ºç«‹resources.tsï¼Œå¯¼å…¥ä¸»è¯­è¨€çš„é…ç½®\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-typescript\",\n        children: \"import translation from '../locales/zh/translation.json';\\n\\nconst resources = {\\n  translation,\\n} as const;\\n\\nexport default resources;\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.ol, {\n      start: \"2\",\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"åœ¨src/@typesä¸‹ç›®å½•ä¸‹å»ºç«‹i18next.d.tsï¼Œå¹¶æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        children: \"import resources from './resources';\\n\\ndeclare module 'i18next' {\\n  interface CustomTypeOptions {\\n    resources: typeof resources;\\n  }\\n}\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"å†æ¬¡è°ƒç”¨tæ–¹æ³•æ—¶ï¼Œå°±èƒ½çœ‹è§ç±»å‹çš„æç¤ºäº†ã€‚\"\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"åœ¨å¤šç§åœºæ™¯ä¸‹çš„ä½¿ç”¨æ–¹å¼\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"åœ¨ç»„ä»¶ä¸­ä½¿ç”¨\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-typescript\",\n        children: \"const { t } = useTranslation();\\nt('global.common.hello')\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.ol, {\n      start: \"2\",\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"åœ¨ç»„ä»¶å¤–ä½¿ç”¨\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"åœ¨ç»„ä»¶ä½œç”¨åŸŸå¤–çš„æ–‡æœ¬ï¼Œå¯ä»¥è°ƒç”¨Translationç»„ä»¶æ¥ä½¿ç”¨ï¼Œä¸ºäº†æ–¹ä¾¿è°ƒç”¨å¯ä»¥å°è£…ä»¥ä¸‹ç»„ä»¶\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-typescript\",\n        children: \"import type { KeyPrefix } from 'i18next';\\nimport { Translation as TranslationBase } from 'react-i18next';\\n\\ntype Keys = KeyPrefix\u003c'translation'\u003e;\\n\\ninterface TranslationProps {\\n  token: Keys;\\n}\\n\\nconst Translation: React.FC\u003cTranslationProps\u003e = ({ token }) =\u003e {\\n  return \u003cTranslationBase\u003e{(t) =\u003e t(token as unknown as any)}\u003c/TranslationBase\u003e;\\n};\\n\\nexport default Translation;\\n\\n\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ä½¿ç”¨å¦‚ä¸‹ï¼š\"\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-typescript\",\n        children: \"const orderOptions = [\\n  {\\n    label: \u003cTranslation token=\\\"global.common.updateTime\\\" /\u003e,\\n    value: 'modify_time',\\n  },\\n  {\\n    label: \u003cTranslation token=\\\"global.common.createTime\\\" /\u003e,\\n    value: 'create_time',\\n  },\\n];\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.ol, {\n      start: \"3\",\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"ç»“åˆæ¨¡æ¿ä½¿ç”¨Tranç»„ä»¶\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-typescript\",\n        children: \"\u003cTrans i18nKey=\\\"global.template.remove_confirm\\\"\u003e\\n  {{ target: t('applications.title') }}\\n  {{ name: card.k8sName }}\\n\u003c/Trans\u003e\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.h2, {\n      children: [\"ç»“åˆ\", _jsx(_components.code, {\n        children: \"googleç¿»è¯‘\"\n      }), \"å®ç°è‡ªåŠ¨åŒ–ç¿»è¯‘è„šæœ¬\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"ç”±äºä¸€äº›å¤æ‚çš„ç¿»è¯‘éœ€è¦ç”¨åˆ°ç¿»è¯‘è½¯ä»¶è¾…åŠ©ï¼Œä½†ç¿»è¯‘è¿‡åä»éœ€äººå·¥è°ƒæ•´ï¼Œä¸€äº›è¯æ€§å·®å¼‚å’Œä¸“æœ‰åè¯ç¿»è¯‘è½¯ä»¶å¹¶ä¸èƒ½å®Œå…¨å‡†ç¡®ç¿»è¯‘ï¼Œå› æ­¤æœ€é€‚åˆçš„è‡ªåŠ¨åŒ–æ–¹æ³•æ˜¯ç¼–å†™ä¸€ä¸ªè„šæœ¬å°†æœªç¿»è¯‘çš„å­—æ®µç¿»è¯‘å¹¶å¡«å†™åˆ°å¯¹åº”æ–‡ä»¶ä¸­ï¼Œå†è¿›è¡Œäººå·¥ä¿®æ­£\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"å®‰è£…\", _jsx(_components.code, {\n        children: \"@vitalets/google-translate-api\"\n      }), \"æ’ä»¶ï¼Œé€šè¿‡æ’ä»¶æ¥è°ƒç”¨googleç¿»è¯‘çš„API\"]\n    }), \"\\n\", _jsx(_components.pre, {\n      children: _jsx(_components.code, {\n        className: \"language-javascript\",\n        children: \"import { translate } from '@vitalets/google-translate-api';\\nimport fs from 'fs';\\nimport { HttpProxyAgent } from 'http-proxy-agent';\\nimport zhText from '../locales/zh/translation.json' assert  { type: \\\"json\\\" };\\nimport enText from '../locales/en/translation.json' assert  { type: \\\"json\\\" };\\nimport { get } from 'lodash-es';\\nimport { set } from 'lodash-es';\\nimport path from 'path';\\n\\nconst enFilePath = path.resolve('./src/locales/en/translation.json');\\n\\nconst args = process.argv.slice(2);\\nconst proxy = args[0]?.match(/(?\u003c=proxy=).*/)[0] || 'http://127.0.0.1:7890';\\nconst timeoutMs = 5000;\\n\\nasync function translateText(sourceText, to) {\\n  const ac = new AbortController();\\n  const timer = setTimeout(() =\u003e ac.abort(), timeoutMs);\\n  const fetchOptions = {\\n    agent: new HttpProxyAgent(proxy),\\n    signal: ac.signal,\\n  };\\n  try {\\n    const { text } = await translate(sourceText, { fetchOptions, to, });\\n    return text\\n  } finally {\\n    clearTimeout(timer);\\n  }\\n}\\n\\nasync function traverseTexts(translations, key = '') {\\n  for (const k in translations) {\\n    const value = translations[k]\\n    const fullKey = `${key ? `${key}.` : ''}${k}`\\n    if (typeof value === 'string') {\\n      // åªç¿»è¯‘æ–°å¢çš„é…ç½®\\n      if (get(enText, fullKey) !== void 0) {\\n        continue\\n      }\\n      console.log('translating:', value)\\n      const translated = await translateText(value, 'en')\\n      set(enText, fullKey, translated)\\n    } else {\\n      await traverseTexts(value, fullKey)\\n    }\\n  }\\n}\\n\\nfunction saveEnTexts() {\\n  const jsonContent = JSON.stringify(enText, null, 2);\\n  fs.writeFileSync(enFilePath, jsonContent, 'utf8');\\n  console.log('Translation completed and saved to locales/en/translation.json');\\n}\\n\\nawait traverseTexts(zhText)\\nsaveEnTexts()\\n\"\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"åœ¨\", _jsx(_components.code, {\n        children: \"package.json\"\n      }), \"ä¸­æ·»åŠ script\", _jsx(_components.code, {\n        children: \"\\\"auto-translate\\\": \\\"node ./src/locales/translate.js\\\"\"\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"åœ¨æ‰¹é‡æ–°å¢ä¸­æ–‡æ–‡æœ¬ä¹‹åï¼Œæ‰§è¡Œ\", _jsx(_components.code, {\n        children: \"npm run auto-translate\"\n      }), \"å³å¯è‡ªåŠ¨å¡«è¡¥ç¼ºæ¼çš„è‹±æ–‡é…ç½®ï¼Œå¯é€šè¿‡\", _jsx(_components.code, {\n        children: \"--proxy=\"\n      }), \"æ¥æŒ‡å®šæœ¬åœ°ä»£ç†åœ°å€ã€‚\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{"title":"ä½¿ç”¨react-i18nextè¿›è¡Œå›½é™…åŒ–é…ç½®","description":"åœ¨reactçš„åº”ç”¨ä¸­å¦‚ä½•è¿›è¡Œå›½é™…åŒ–é…ç½®ï¼Œå¹¶é€‚é…å¤šç§ä½¿ç”¨åœºæ™¯ä»¥åŠå¼€å‘ä½“éªŒçš„æå‡","public":true,"date":"2024-07-25 19:03:00","category":"framework"}},"frontMatter":{"title":"ä½¿ç”¨react-i18nextè¿›è¡Œå›½é™…åŒ–é…ç½®","description":"åœ¨reactçš„åº”ç”¨ä¸­å¦‚ä½•è¿›è¡Œå›½é™…åŒ–é…ç½®ï¼Œå¹¶é€‚é…å¤šç§ä½¿ç”¨åœºæ™¯ä»¥åŠå¼€å‘ä½“éªŒçš„æå‡","public":true,"date":"2024-07-25 19:03:00","category":"framework"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"react-i18next"},"buildId":"2XlT3rGw8n9OHW1k7dVgT","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>