<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>è›‹é»„æ´¾ç¢å†°å†°</title><meta name="description" content="è›‹é»„æ´¾ç¢å†°å†°çš„åšå®¢"/><link rel="icon" href="/favicon.ico"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"/><meta name="next-head-count" content="5"/><link rel="preload" href="/_next/static/css/ab184196c72fe85b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ab184196c72fe85b.css" data-n-g=""/><link rel="preload" href="/_next/static/css/4a0c5542377ce400.css" as="style"/><link rel="stylesheet" href="/_next/static/css/4a0c5542377ce400.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-1d2bf428d878d876.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-e267bb9839e5051c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-fe85ddc63867fc19.js" defer=""></script><script src="/_next/static/chunks/347-34557e8e6f4e11a0.js" defer=""></script><script src="/_next/static/chunks/966-c28dfefcc6bfc2ef.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-31076c76e5eeee58.js" defer=""></script><script src="/_next/static/uLUvI9Sb-fn169cVF0wll/_buildManifest.js" defer=""></script><script src="/_next/static/uLUvI9Sb-fn169cVF0wll/_ssgManifest.js" defer=""></script><script src="/_next/static/uLUvI9Sb-fn169cVF0wll/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="Layout_container__CSAqU"><header class="Header_header__Z4YN5"><a href="/">è›‹é»„æ´¾ç¢å†°å†°</a><nav><ul><li><a href="/#posts">æ–‡ç« </a></li><li><a href="/about">å…³äº</a></li></ul></nav></header><main><div class="Layout_banner__0qsJd"><h1>Next.js åŸºæœ¬ä½¿ç”¨</h1><p>Next.js ä»æ­å»ºåˆ°éƒ¨ç½²</p><div>2021-09-09 20:23:00</div></div><div class="content-container"><h1>Next.js åŸºæœ¬ä½¿ç”¨</h1>
<p>next.js æ˜¯åŸºäºReactçš„å‰ç«¯æ¡†æ¶ï¼Œä¸»è¦ç”¨äºæ”¯æŒé™æ€æ¸²æŸ“æˆ–æœåŠ¡ç«¯æ¸²æŸ“ã€‚</p>
<h3>èƒŒæ™¯</h3>
<h4>SPA ğŸ’†</h4>
<p>single-page applicationï¼Œå³å•é¡µé¢åº”ç”¨ï¼Œæ˜¯ä¸€ç§ç½‘ç»œåº”ç”¨ç¨‹åºæˆ–ç½‘ç«™çš„æ¨¡å‹ï¼Œå®ƒé€šè¿‡åŠ¨æ€é‡å†™å½“å‰é¡µé¢æ¥ä¸ç”¨æˆ·äº¤äº’ï¼Œé¿å…äº†é¡µé¢ä¹‹é—´åˆ‡æ¢æ‰“æ–­ç”¨æˆ·ä½“éªŒã€‚æ‰€æœ‰å¿…è¦çš„ä»£ç ï¼ˆ<code>HTML</code>ã€<code>JavaScript</code>å’Œ<code>CSS</code>ï¼‰éƒ½é€šè¿‡å•ä¸ªé¡µé¢çš„åŠ è½½è€Œæ£€ç´¢ï¼Œæˆ–è€…æ ¹æ®éœ€è¦ï¼ˆé€šå¸¸æ˜¯ä¸ºå“åº”ç”¨æˆ·æ“ä½œï¼‰åŠ¨æ€è£…è½½é€‚å½“çš„èµ„æºå¹¶æ·»åŠ åˆ°é¡µé¢ï¼Œé¡µé¢åœ¨ä»»ä½•æ—¶é—´ç‚¹éƒ½ä¸ä¼šé‡æ–°åŠ è½½ï¼Œä¹Ÿä¸ä¼šå°†æ§åˆ¶è½¬ç§»åˆ°å…¶ä»–é¡µé¢ã€‚</p>
<h5>ä¼˜ç¼ºç‚¹</h5>
<p>ä¼˜ç‚¹ï¼š</p>
<ul>
<li>
<p>ç”¨æˆ·ä½“éªŒå¥½ï¼Œé¡µé¢åˆ‡æ¢é€Ÿåº¦å¿«</p>
</li>
<li>
<p>è‰¯å¥½çš„å‰åç«¯åˆ†ç¦»ï¼Œåˆ†å·¥æ˜ç¡®</p>
</li>
</ul>
<p>ç¼ºç‚¹ï¼š</p>
<ul>
<li>
<p>ä¸åˆ©äºSEO</p>
</li>
<li>
<p>é¦–å±æ¸²æŸ“é€Ÿåº¦è¾ƒæ…¢</p>
</li>
</ul>
<h4>CSR å’Œ SSR</h4>
<p>CSRï¼šClient Side Renderï¼Œå³å®¢æˆ·ç«¯æ¸²æŸ“ï¼ŒæœåŠ¡ç«¯åªè¿”å›ä¸€ä¸ªhtmlæ¨¡æ¿ï¼Œé¡µé¢çš„å†…å®¹é€šè¿‡è¿è¡Œjsè¿è¡Œã€‚Angularã€Reactå’ŒVueæ„å»ºçš„åº”ç”¨ï¼Œé»˜è®¤éƒ½æ˜¯å®¢æˆ·ç«¯æ¸²æŸ“ã€‚</p>
<p>SSRï¼šServer Side Renderï¼Œå³æœåŠ¡ç«¯æ¸²æŸ“ã€‚é¡µé¢ä¸Šçš„å†…å®¹é€šè¿‡æœåŠ¡ç«¯æ¸²æŸ“ç”Ÿæˆï¼Œç„¶åå†å°†å®Œæ•´çš„htmlè¿”å›ç»™æµè§ˆå™¨ã€‚</p>
<h3>å¿«é€Ÿå¼€å§‹</h3>
<h4>åˆ›å»ºé¡¹ç›®</h4>
<p>ä½¿ç”¨<code>create-next-app</code>åˆ›å»ºæ–°çš„ Next.js åº”ç”¨ç¨‹åº</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span>npx create-next-app --typescript
</span><span></span><span style="color:#65737e"># or</span><span>
</span>yarn create next-app --typescript
</code></pre>
<h4>åŸºæœ¬ç‰¹æ€§</h4>
<h5>é¡µé¢</h5>
<p>åœ¨ Next.js ä¸­ï¼Œä¸€ä¸ª <strong>pageï¼ˆé¡µé¢ï¼‰</strong> å°±æ˜¯ä¸€ä¸ªä» <code>.js</code>ã€<code>jsx</code>ã€<code>.ts</code> æˆ– <code>.tsx</code> æ–‡ä»¶å¯¼å‡ºï¼ˆexportï¼‰çš„ <a href="https://reactjs.org/docs/components-and-props.html">React ç»„ä»¶</a> ï¼Œè¿™äº›æ–‡ä»¶å­˜æ”¾åœ¨ <code>pages</code> ç›®å½•ä¸‹ã€‚æ¯ä¸ª pageï¼ˆé¡µé¢ï¼‰éƒ½ä½¿ç”¨å…¶æ–‡ä»¶åä½œä¸ºè·¯ç”±ï¼ˆrouteï¼‰ã€‚</p>
<h5>è·¯ç”±</h5>
<p>â€‹	æ–‡ä»¶ç›®å½• â†’ è·¯ç”±</p>
<ul>
<li><code>pages/index.js</code>  â†’ <code>/</code></li>
<li><code>pages/blog/index.js</code> â†’ <code>/blog</code></li>
<li><code>pages/blog.js</code>â†’ <code>/blog</code></li>
<li><code>pages/blog/[id].js</code>â†’ <code>/blog/:id</code></li>
<li><code>pages/[username]/settings.js</code> â†’ <code>/:username/settings</code></li>
<li><code>pages/post/[...all].js</code> â†’ <code>/post/*</code> (<code>/post/2020/id/title</code>)</li>
</ul>
<p>é€šè¿‡useRouterè·å–åŠ¨æ€å‚æ•°ï¼Œå¦‚ä¸‹ï¼š</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#ebcb8b">const router</span><span> = useRouter();
</span><span></span><span style="color:#ebcb8b">const</span><span> { all } = router.query;
</span></code></pre>
<p>è·¯ç”±è·³è½¬æœ‰ä¸¤ç§æ–¹å¼ï¼Œé€šè¿‡Linkç»„ä»¶æˆ–è€…useRouter</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> Link </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;next/link&#x27;</span><span>
</span>
<span></span><span style="color:#b48ead">const</span><span> Post: NextPage = </span><span class="hljs-function">() =&gt;</span><span> {
</span>    ...
<span>    </span><span style="color:#b48ead">return</span><span> (
</span><span>        </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">div</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">            </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">p</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">{Array.isArray(all) ? all.join(&#x27;/&#x27;) : all}</span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">p</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">            </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">Link</span><span class="xml" style="color:#bf616a"> </span><span class="xml hljs-attr" style="color:#bf616a">href</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">&quot;/blog/123&quot;</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">a</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">blog</span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">a</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">Link</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">        </span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">div</span><span class="xml" style="color:#bf616a">&gt;</span><span>
</span>    );
<!-- -->}
<!-- -->
</code></pre>
<h5>è·å–æ•°æ®</h5>
<ol>
<li>getStaticProps</li>
</ol>
<p>ä½¿ç”¨getStaticPropsæ–¹æ³•ï¼Œnext.jsä¼šåœ¨æ‰§è¡Œ<code>next-build</code>çš„æ—¶å€™é¢„æ¸²æŸ“é¡µé¢ï¼Œå¹¶å°†getStaticPropsçš„è¿”å›ä½œä¸ºpropsä¼ ç»™ç»„ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰§è¡Œå®Œbuildä¹‹åï¼Œæ•°æ®å°±å˜æˆé™æ€çš„æ•°æ®äº†ã€‚</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">export</span><span> </span><span style="color:#b48ead">async</span><span> </span><span class="hljs-function" style="color:#b48ead">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#8fa1b3">getStaticProps</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#d08770">context</span><span class="hljs-function">) </span><span>{
</span><span>    </span><span style="color:#b48ead">const</span><span> res = </span><span style="color:#b48ead">await</span><span> fetch(</span><span style="color:#a3be8c">`https://service-go08i9b4-1301241041.gz.apigw.tencentcs.com/products`</span><span>);
</span><span>    </span><span style="color:#b48ead">const</span><span> products = </span><span style="color:#b48ead">await</span><span> res.json();
</span>
<span>    </span><span style="color:#b48ead">if</span><span> (!products) {
</span><span>        </span><span style="color:#b48ead">return</span><span> {
</span><span>            </span><span class="hljs-attr">notFound</span><span>: </span><span style="color:#d08770">true</span><span>,
</span>        }
<!-- -->    }
<!-- -->
<span>    </span><span style="color:#b48ead">return</span><span> {
</span><span>        </span><span class="hljs-attr">props</span><span>: { </span><span class="hljs-attr">products</span><span>: products </span><span style="color:#b48ead">as</span><span> Products }, </span><span style="color:#65737e">// will be passed to the page component as props</span><span>
</span>    }
<!-- -->}
</code></pre>
<ol start="2">
<li>getServerSideProps</li>
</ol>
<p>ä½¿ç”¨getServerSidePropsæ–¹æ³•ï¼Œnext.jsä¼šåœ¨æ¯ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™å°†è¿”å›ç»“æœä½œä¸ºpropsä¼ ç»™ç»„ä»¶ã€‚ä½¿ç”¨getServerSidePropsæ¥è·å–æ•°æ®ï¼Œè™½ç„¶å‰§æœ‰å®æ—¶æ€§ï¼Œä½†æ˜¯å“åº”é€Ÿåº¦å°†æ¯”getStaticPropsæ…¢ï¼Œå› ä¸ºæ¯ä¸€æ¬¡éƒ½éœ€è¦è¯·æ±‚æ–°çš„æ•°æ®ç„¶åè®¡ç®—ç»“æœï¼Œå¹¶ä¸”ä¸èƒ½åœ¨æ²¡æœ‰é¢å¤–çš„é…ç½®ä¸‹è¢«CDNç¼“å­˜ã€‚</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span class="hljs-function" style="color:#b48ead">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#8fa1b3">Page</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#d08770">{ data }</span><span class="hljs-function">) </span><span>{
</span><span>  </span><span style="color:#65737e">// Render data...</span><span>
</span>}
<!-- -->
<span></span><span style="color:#65737e">// This gets called on every request</span><span>
</span><span></span><span style="color:#b48ead">export</span><span> </span><span style="color:#b48ead">async</span><span> </span><span class="hljs-function" style="color:#b48ead">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#8fa1b3">getServerSideProps</span><span class="hljs-function">(</span><span class="hljs-function">) </span><span>{
</span><span>  </span><span style="color:#65737e">// Fetch data from external API</span><span>
</span><span>  </span><span style="color:#b48ead">const</span><span> res = </span><span style="color:#b48ead">await</span><span> fetch(</span><span style="color:#a3be8c">`https://.../data`</span><span>)
</span><span>  </span><span style="color:#b48ead">const</span><span> data = </span><span style="color:#b48ead">await</span><span> res.json()
</span>
<span>  </span><span style="color:#65737e">// Pass data to the page via props</span><span>
</span><span>  </span><span style="color:#b48ead">return</span><span> { </span><span class="hljs-attr">props</span><span>: { data } }
</span>}
<!-- -->
<span></span><span style="color:#b48ead">export</span><span> </span><span style="color:#b48ead">default</span><span> Page
</span></code></pre>
<h5>CSSæ”¯æŒ</h5>
<ol>
<li>
<p>å…¨å±€æ ·å¼</p>
<p>åœ¨<code>pages/_app.tsx</code>ä¸­å¯¼å…¥cssæ–‡ä»¶ï¼ŒåŒæ ·æ”¯æŒä»<code>node_modules</code>ç›®å½•å¯¼å…¥ã€‚</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> </span><span style="color:#a3be8c">&#x27;../styles/globals.css&#x27;</span><span>
</span><span></span><span style="color:#b48ead">import</span><span> </span><span style="color:#a3be8c">&#x27;bootstrap/dist/css/bootstrap.css&#x27;</span><span>
</span></code></pre>
</li>
<li>
<p>ç»„ä»¶æ ·å¼</p>
<p>Next.js é€šè¿‡ <code>[name].module.css</code> æ–‡ä»¶å‘½åçº¦å®šæ¥æ”¯æŒ <a href="https://github.com/css-modules/css-modules">CSS æ¨¡å—</a> ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è®¾ <code>components/</code> ç›®å½•ä¸‹æœ‰ä¸€ä¸ªå¯é‡ç”¨ <code>Button</code> ç»„ä»¶ï¼š</p>
<p>é¦–å…ˆï¼Œåˆ›å»º <code>components/Button.module.css</code> æ–‡ä»¶å¹¶å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#bf616a">.error</span><span> {
</span><span>  </span><span style="color:#ebcb8b">color</span><span>: white;
</span><span>  </span><span style="color:#ebcb8b">background-color</span><span>: red;
</span>}
</code></pre>
<p>ç„¶åï¼Œåˆ›å»º <code>components/Button.js</code> æ–‡ä»¶ï¼Œå¯¼å…¥ï¼ˆimportï¼‰å¹¶ä½¿ç”¨ä¸Šè¿° CSS æ–‡ä»¶ï¼š</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> styles </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;./Button.module.css&#x27;</span><span>
</span>
<span>export </span><span style="color:#b48ead">function</span><span> Button() {
</span><span>  </span><span style="color:#b48ead">return</span><span> (
</span>    &lt;button
<span>      </span><span style="color:#b48ead">type</span><span>=&quot;button&quot;
</span><span>      // Note how the &quot;error&quot; </span><span style="color:#b48ead">class</span><span> </span><span style="color:#b48ead">is</span><span> accessed </span><span style="color:#b48ead">as</span><span> a property </span><span style="color:#b48ead">on</span><span> the imported
</span><span>      // `styles` </span><span style="color:#b48ead">object</span><span>.
</span>      className={styles.error}
<!-- -->    &gt;
<!-- -->      Destroy
<!-- -->    &lt;/button&gt;
<!-- -->  )
<!-- -->}
</code></pre>
<p>å¦å¤–ï¼ŒNext.jså…è®¸å¯¼å…¥ï¼ˆimportï¼‰å…·æœ‰ <code>.scss</code> å’Œ <code>.sass</code> æ‰©å±•åçš„ Sass æ–‡ä»¶ï¼Œåªè¦ç¡®ä¿å®‰è£…äº†sassï¼Œå³å¯ä½¿ç”¨ã€‚</p>
</li>
</ol>
<h5>å¸¸ç”¨ç»„ä»¶</h5>
<ol>
<li>
<p><code>next/image</code></p>
<p>Next.js çš„ Image ç»„ä»¶ï¼ˆå³ <a href="https://www.nextjs.cn/docs/api-reference/next/image"><code>next/image</code></a>ï¼‰æ˜¯å¯¹ HTML çš„ <code>&lt;img&gt;</code> å…ƒç´ çš„æ‰©å±•ï¼Œè·Ÿè¿›äº†æœ€æ–°çš„ web æŠ€æœ¯ã€‚</p>
<p>è‡ªåŠ¨å›¾ç‰‡ä¼˜åŒ–åŠŸèƒ½ï¼ˆAutomatic Image Optimizationï¼‰èƒ½å¤Ÿè°ƒæ•´å›¾ç‰‡å°ºå¯¸ã€ä¼˜åŒ–å›¾ç‰‡å¹¶ä»¥æœ€æ–°çš„ <a href="https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Image_types">WebP</a> æ ¼å¼ä¼ è¾“å›¾ç‰‡ï¼ˆå¦‚æœæµè§ˆå™¨æ”¯æŒ WebP æ ¼å¼çš„è¯ï¼‰ã€‚è¿™æ ·å°±å¯ä»¥é¿å…å°†è¾ƒå¤§çš„å›¾ç‰‡ä¼ é€åˆ°è§†å£ï¼ˆviewportï¼‰è¾ƒå°çš„è®¾å¤‡ä¸Šã€‚æ­¤åŠŸèƒ½è¿˜å…è®¸ Next.js è‡ªåŠ¨é‡‡ç”¨æœªæ¥çš„å›¾ç‰‡æ ¼å¼ï¼Œå¹¶å°†å…¶ä¼ è¾“ç»™æ”¯æŒè¿™äº›æ ¼å¼çš„æµè§ˆå™¨ã€‚</p>
<p>è‡ªåŠ¨å›¾ç‰‡ä¼˜åŒ–åŠŸèƒ½å¯ä»¥æ”¯æŒä»»ä½•å›¾ç‰‡æ¥æºã€‚å³ä½¿æ˜¯æ‰˜ç®¡åœ¨å¤–éƒ¨æ•°æ®æºä¸Šï¼ˆä¾‹å¦‚ï¼ŒCMSï¼‰ï¼Œä»å¯å¯¹å›¾ç‰‡è¿›è¡Œä¼˜åŒ–ã€‚</p>
<p>Next.js æ— éœ€åœ¨æ„å»ºæ—¶ä¼˜åŒ–å›¾ç‰‡ï¼Œè€Œæ˜¯æ ¹æ®ç”¨æˆ·çš„è¯·æ±‚æŒ‰éœ€ä¼˜åŒ–å›¾ç‰‡ã€‚ä¸é™æ€ç«™ç‚¹ç”Ÿæˆå™¨å’Œçº¯é™æ€è§£å†³æ–¹æ¡ˆä¸åŒï¼Œæ— è®ºå‘å¸ƒ 10 å¼ è¿˜æ˜¯ 1000 ä¸‡å¼ å›¾ç‰‡ï¼Œæ„å»ºæ—¶é—´éƒ½ä¸ä¼šå¢åŠ ã€‚</p>
<p>å›¾ç‰‡é»˜è®¤æ˜¯å»¶è¿ŸåŠ è½½çš„ã€‚è¿™æ„å‘³ç€ä½ çš„é¡µé¢ä¸ä¼šå› ä¸ºåŠ è½½è§†å£ï¼ˆviewportï¼‰å¤–çš„å›¾ç‰‡è€Œå½±å“é¡µé¢çš„åŠ è½½é€Ÿåº¦ã€‚å½“å›¾ç‰‡è¿›å…¥è§†å£ï¼ˆviewportï¼‰æ—¶æ‰åŠ è½½ã€‚</p>
<p>å§‹ç»ˆä»¥è¿™ç§æ–¹å¼æ¸²æŸ“å›¾ç‰‡æ˜¯ä¸ºäº†é¿å… <a href="https://web.dev/cls/">ç´¯è®¡å¸ƒå±€åç§»ï¼ˆCumulative Layout Shiftï¼‰</a>ï¼Œæ­¤ <a href="https://web.dev/vitals/">Core Web Vital</a> è¢« Google ä½œä¸ºå‚æ•°ç”¨äº <a href="https://webmasters.googleblog.com/2020/05/evaluating-page-experience.html">æœç´¢æ’å</a>ã€‚</p>
<p>ä½¿ç”¨ï¼š</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> Image </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;next/image&#x27;</span><span>
</span>
<span></span><span class="hljs-function" style="color:#b48ead">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#8fa1b3">Home</span><span class="hljs-function">(</span><span class="hljs-function">) </span><span>{
</span><span>  </span><span style="color:#b48ead">return</span><span> (
</span><span>    </span><span class="xml" style="color:#bf616a">&lt;&gt;</span><span class="xml">
</span><span class="xml">      </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">h1</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">My Homepage</span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">h1</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">      </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">Image</span><span class="xml" style="color:#bf616a">
</span><span class="xml" style="color:#bf616a">        </span><span class="xml hljs-attr" style="color:#bf616a">src</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">&quot;/me.png&quot;</span><span class="xml" style="color:#bf616a">
</span><span class="xml" style="color:#bf616a">        </span><span class="xml hljs-attr" style="color:#bf616a">alt</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">&quot;Picture of the author&quot;</span><span class="xml" style="color:#bf616a">
</span><span class="xml" style="color:#bf616a">        </span><span class="xml hljs-attr" style="color:#bf616a">width</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">{500}</span><span class="xml" style="color:#bf616a">
</span><span class="xml" style="color:#bf616a">        </span><span class="xml hljs-attr" style="color:#bf616a">height</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">{500}</span><span class="xml" style="color:#bf616a">
</span><span class="xml" style="color:#bf616a">      /&gt;</span><span class="xml">
</span><span class="xml">      </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">p</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">Welcome to my homepage!</span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">p</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">    </span><span class="xml" style="color:#bf616a">&lt;/&gt;</span><span>
</span>  )
<!-- -->}
<!-- -->
<span></span><span style="color:#b48ead">export</span><span> </span><span style="color:#b48ead">default</span><span> Home
</span></code></pre>
</li>
<li>
<p><code>next/head</code></p>
<p>ç”¨äºå°† HTML æ ‡ç­¾æ·»åŠ åˆ°é¡µé¢çš„ <code>head</code> ä¸­</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">import</span><span> Head </span><span style="color:#b48ead">from</span><span> </span><span style="color:#a3be8c">&#x27;next/head&#x27;</span><span>
</span>
<span></span><span class="hljs-function" style="color:#b48ead">function</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#8fa1b3">IndexPage</span><span class="hljs-function">(</span><span class="hljs-function">) </span><span>{
</span><span>  </span><span style="color:#b48ead">return</span><span> (
</span><span>    </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">div</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">      </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">Head</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">        </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">title</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">My page title</span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">title</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">        </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">meta</span><span class="xml" style="color:#bf616a"> </span><span class="xml hljs-attr" style="color:#bf616a">name</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">&quot;viewport&quot;</span><span class="xml" style="color:#bf616a"> </span><span class="xml hljs-attr" style="color:#bf616a">content</span><span class="xml" style="color:#bf616a">=</span><span class="xml" style="color:#a3be8c">&quot;initial-scale=1.0, width=device-width&quot;</span><span class="xml" style="color:#bf616a"> /&gt;</span><span class="xml">
</span><span class="xml">      </span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">Head</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">      </span><span class="xml" style="color:#bf616a">&lt;</span><span class="xml" style="color:#bf616a">p</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">Hello world!</span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">p</span><span class="xml" style="color:#bf616a">&gt;</span><span class="xml">
</span><span class="xml">    </span><span class="xml" style="color:#bf616a">&lt;/</span><span class="xml" style="color:#bf616a">div</span><span class="xml" style="color:#bf616a">&gt;</span><span>
</span>  )
<!-- -->}
<!-- -->
<span></span><span style="color:#b48ead">export</span><span> </span><span style="color:#b48ead">default</span><span> IndexPage
</span></code></pre>
</li>
</ol>
<h4>é…ç½®</h4>
<h5>ç®€ä»‹</h5>
<p>å¯¹äº Next.js çš„è‡ªå®šä¹‰é«˜çº§è¡Œä¸ºï¼Œå¯ä»¥åœ¨é¡¹ç›®ç›®å½•çš„æ ¹ç›®å½•ï¼ˆpackage.json æ—è¾¹ï¼‰åˆ›å»ºä¸€ä¸ª next.config.jsã€‚</p>
<p><code>next.config.js</code>æ˜¯ä¸€ä¸ªNode.jsæ¨¡å—ï¼Œä¸æ˜¯ä¸€ä¸ªjsonæ–‡ä»¶ã€‚</p>
<p>å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">module</span><span>.</span><span style="color:#b48ead">exports</span><span> = {
</span><span>  </span><span style="color:#65737e">/* config options here */</span><span>
</span>}
</code></pre>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼š</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#d08770">module</span><span>.</span><span style="color:#d08770">exports</span><span> = </span><span class="hljs-function" style="color:#d08770">(phase, { defaultConfig })</span><span class="hljs-function"> =&gt;</span><span> {
</span><span>  </span><span style="color:#b48ead">return</span><span> {
</span>    /* config options here */
<!-- -->  }
<!-- -->}
</code></pre>
<p>é€šè¿‡configçš„ç±»å‹å¤§æ¦‚å¯ä»¥çŸ¥é“å®ƒæ”¯æŒå“ªäº›é…ç½®ï¼š</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#b48ead">export</span><span> </span><span style="color:#b48ead">declare</span><span> </span><span style="color:#b48ead">type</span><span> NextConfig = {
</span><span>    [key: </span><span style="color:#d08770">string</span><span>]: </span><span style="color:#d08770">any</span><span>;
</span>} &amp; {
<span>    i18n?: I18NConfig | </span><span style="color:#d08770">null</span><span>;
</span>    eslint?: ESLintConfig;
<!-- -->    typescript?: TypeScriptConfig;
<span>    headers?: </span><span class="hljs-function">() =&gt;</span><span> </span><span style="color:#d08770">Promise</span><span>&lt;Header[]&gt;;
</span><span>    rewrites?: </span><span class="hljs-function">() =&gt;</span><span> </span><span style="color:#d08770">Promise</span><span>&lt;Rewrite[] | {
</span><span>        </span><span class="hljs-attr">beforeFiles</span><span>: Rewrite[];
</span>        afterFiles: Rewrite[];
<!-- -->        fallback: Rewrite[];
<!-- -->    }&gt;;
<span>    redirects?: </span><span class="hljs-function">() =&gt;</span><span> </span><span style="color:#d08770">Promise</span><span>&lt;Redirect[]&gt;;
</span><span>    webpack5?: </span><span style="color:#d08770">false</span><span>;
</span><span>    excludeDefaultMomentLocales?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>    webpack?: (</span><span class="hljs-function">(</span><span class="hljs-function" style="color:#d08770">config: </span><span class="hljs-function" style="color:#d08770">any</span><span class="hljs-function" style="color:#d08770">, context: {
</span><span class="hljs-function" style="color:#d08770">        dir: </span><span class="hljs-function" style="color:#d08770">string</span><span class="hljs-function" style="color:#d08770">;
</span><span class="hljs-function" style="color:#d08770">        dev: </span><span class="hljs-function" style="color:#d08770">boolean</span><span class="hljs-function" style="color:#d08770">;
</span><span class="hljs-function" style="color:#d08770">        isServer: </span><span class="hljs-function" style="color:#d08770">boolean</span><span class="hljs-function" style="color:#d08770">;
</span><span class="hljs-function" style="color:#d08770">        buildId: </span><span class="hljs-function" style="color:#d08770">string</span><span class="hljs-function" style="color:#d08770">;
</span><span class="hljs-function" style="color:#d08770">        config: NextConfigComplete;
</span><span class="hljs-function" style="color:#d08770">        defaultLoaders: {
</span><span class="hljs-function" style="color:#d08770">            babel: </span><span class="hljs-function" style="color:#d08770">any</span><span class="hljs-function" style="color:#d08770">;
</span><span class="hljs-function" style="color:#d08770">        };
</span><span class="hljs-function" style="color:#d08770">        totalPages: </span><span class="hljs-function" style="color:#d08770">number</span><span class="hljs-function" style="color:#d08770">;
</span><span class="hljs-function" style="color:#d08770">        webpack: </span><span class="hljs-function" style="color:#d08770">any</span><span class="hljs-function" style="color:#d08770">;
</span><span class="hljs-function" style="color:#d08770">    }</span><span class="hljs-function">) =&gt;</span><span> </span><span style="color:#d08770">any</span><span>) | </span><span style="color:#d08770">null</span><span>;
</span><span>    trailingSlash?: </span><span style="color:#d08770">boolean</span><span>;
</span>    env?: {
<span>        [key: </span><span style="color:#d08770">string</span><span>]: </span><span style="color:#d08770">string</span><span>;
</span>    };
<span>    distDir?: </span><span style="color:#d08770">string</span><span>;
</span><span>    cleanDistDir?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>    assetPrefix?: </span><span style="color:#d08770">string</span><span>;
</span><span>    useFileSystemPublicRoutes?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>    generateBuildId?: </span><span class="hljs-function">() =&gt;</span><span> </span><span style="color:#d08770">string</span><span> | </span><span style="color:#d08770">null</span><span> | </span><span style="color:#d08770">Promise</span><span>&lt;</span><span style="color:#d08770">string</span><span> | </span><span style="color:#d08770">null</span><span>&gt;;
</span><span>    generateEtags?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>    pageExtensions?: </span><span style="color:#d08770">string</span><span>[];
</span><span>    compress?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>    poweredByHeader?: </span><span style="color:#d08770">boolean</span><span>;
</span>    images?: ImageConfig;
<!-- -->    devIndicators?: {
<span>        buildActivity?: </span><span style="color:#d08770">boolean</span><span>;
</span>    };
<!-- -->    onDemandEntries?: {
<span>        maxInactiveAge?: </span><span style="color:#d08770">number</span><span>;
</span><span>        pagesBufferLength?: </span><span style="color:#d08770">number</span><span>;
</span>    };
<!-- -->    amp?: {
<span>        canonicalBase?: </span><span style="color:#d08770">string</span><span>;
</span>    };
<span>    basePath?: </span><span style="color:#d08770">string</span><span>;
</span>    sassOptions?: {
<span>        [key: </span><span style="color:#d08770">string</span><span>]: </span><span style="color:#d08770">any</span><span>;
</span>    };
<span>    productionBrowserSourceMaps?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>    optimizeFonts?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>    reactStrictMode?: </span><span style="color:#d08770">boolean</span><span>;
</span>    publicRuntimeConfig?: {
<span>        [key: </span><span style="color:#d08770">string</span><span>]: </span><span style="color:#d08770">any</span><span>;
</span>    };
<!-- -->    serverRuntimeConfig?: {
<span>        [key: </span><span style="color:#d08770">string</span><span>]: </span><span style="color:#d08770">any</span><span>;
</span>    };
<!-- -->    httpAgentOptions?: {
<span>        keepAlive?: </span><span style="color:#d08770">boolean</span><span>;
</span>    };
<!-- -->    future?: {
<span>        </span><span style="color:#65737e">/**
</span><span style="color:#65737e">         * </span><span class="hljs-doctag" style="color:#65737e">@deprecated </span><span style="color:#65737e">this options was moved to the top level
</span><span style="color:#65737e">         */</span><span>
</span><span>        webpack5?: </span><span style="color:#d08770">false</span><span>;
</span><span>        strictPostcssConfiguration?: </span><span style="color:#d08770">boolean</span><span>;
</span>    };
<!-- -->    experimental?: {
<span>        swcMinify?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        swcLoader?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        cpus?: </span><span style="color:#d08770">number</span><span>;
</span><span>        sharedPool?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        plugins?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        profiling?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        isrFlushToDisk?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        reactMode?: </span><span style="color:#a3be8c">&#x27;legacy&#x27;</span><span> | </span><span style="color:#a3be8c">&#x27;concurrent&#x27;</span><span> | </span><span style="color:#a3be8c">&#x27;blocking&#x27;</span><span>;
</span><span>        workerThreads?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        pageEnv?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        optimizeImages?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        optimizeCss?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        scrollRestoration?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        stats?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        externalDir?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        conformance?: </span><span style="color:#d08770">boolean</span><span>;
</span>        amp?: {
<span>            optimizer?: </span><span style="color:#d08770">any</span><span>;
</span><span>            validator?: </span><span style="color:#d08770">string</span><span>;
</span><span>            skipValidation?: </span><span style="color:#d08770">boolean</span><span>;
</span>        };
<span>        reactRoot?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        disableOptimizedLoading?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        gzipSize?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        craCompat?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        esmExternals?: </span><span style="color:#d08770">boolean</span><span> | </span><span style="color:#a3be8c">&#x27;loose&#x27;</span><span>;
</span><span>        staticPageGenerationTimeout?: </span><span style="color:#d08770">number</span><span>;
</span><span>        isrMemoryCacheSize?: </span><span style="color:#d08770">number</span><span>;
</span><span>        nftTracing?: </span><span style="color:#d08770">boolean</span><span>;
</span><span>        concurrentFeatures?: </span><span style="color:#d08770">boolean</span><span>;
</span>    };
<!-- -->};
</code></pre>
<h4>éƒ¨ç½²</h4>
<p>nextçš„éƒ¨ç½²ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼</p>
<h5>Vercel</h5>
<p>Vercel (ä¹‹å‰ä¹Ÿå« Zeit æˆ– now.sh) æ˜¯ä¸€å®¶æä¾›é™æ€ç½‘ç«™æ‰˜ç®¡çš„äº‘å¹³å°ï¼Œæ”¯æŒä» Github, GitLab, Bitbucket ç­‰ä»£ç ä»“åº“ä¸­è‡ªåŠ¨æ‹‰å–ä»£ç  ç„¶åè¿›è¡Œé¡¹ç›®æ‰“åŒ…å’Œéƒ¨ç½²ç­‰åŠŸèƒ½ã€‚ä½†æ˜¯å›½å†…è®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œåœ¨æ­¤ä¸å¤šåšä»‹ç»ã€‚</p>
<h5>Node.jsæœåŠ¡</h5>
<p>Next.js å¯ä»¥éƒ¨ç½²åˆ°ä»»ä½•æ”¯æŒ Node.js çš„æ‰˜ç®¡æä¾›å•†å¤„ã€‚</p>
<p>ç¡®ä¿ä½ çš„ <code>package.json</code> æ–‡ä»¶ä¸­è®¾ç½®äº† <code>&quot;build&quot;</code> å’Œ <code>&quot;start&quot;</code> è„šæœ¬ï¼š</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span>{
</span><span>  </span><span class="hljs-attr">&quot;scripts&quot;</span><span>: {
</span><span>    </span><span class="hljs-attr">&quot;dev&quot;</span><span>: </span><span style="color:#a3be8c">&quot;next&quot;</span><span>,
</span><span>    </span><span class="hljs-attr">&quot;build&quot;</span><span>: </span><span style="color:#a3be8c">&quot;next build&quot;</span><span>,
</span><span>    </span><span class="hljs-attr">&quot;start&quot;</span><span>: </span><span style="color:#a3be8c">&quot;next start&quot;</span><span>
</span>  }
<!-- -->}
</code></pre>
<h5>Docker Image</h5>
<p>æ‰“æˆé•œåƒï¼Œå¯ä»¥éƒ¨ç½²åˆ°dockerå®¹å™¨é‡Œï¼Œä¹Ÿå¯ä»¥éƒ¨ç½²åˆ°å®¹å™¨ç¼–æ’å™¨é‡Œï¼ˆkubernetesæˆ–è€…HashiCorp Nomadï¼‰ã€‚</p>
<p>Dockerfileæ–‡ä»¶å‚è€ƒï¼š</p>
<pre style="display:block;overflow-x:auto;background:#2b303b;color:#c0c5ce;padding:0.5em"><code class="block-code" style="white-space:pre"><span style="color:#65737e"># Install dependencies only when needed</span><span>
</span><span></span><span style="color:#b48ead">FROM</span><span> node:alpine AS deps
</span><span></span><span style="color:#65737e"># Check https://github.com/nodejs/docker-node/tree/b4117f9333da4138b03a546ec926ef50a31506c3#nodealpine to understand why libc6-compat might be needed.</span><span>
</span><span></span><span style="color:#b48ead">RUN</span><span class="bash"> apk add --no-cache libc6-compat</span><span>
</span><span></span><span style="color:#b48ead">WORKDIR</span><span class="bash"> /app</span><span>
</span><span></span><span style="color:#b48ead">COPY</span><span class="bash"> package.json yarn.lock ./</span><span>
</span><span></span><span style="color:#b48ead">RUN</span><span class="bash"> yarn install --frozen-lockfile</span><span>
</span>
<span></span><span style="color:#65737e"># Rebuild the source code only when needed</span><span>
</span><span></span><span style="color:#b48ead">FROM</span><span> node:alpine AS builder
</span><span></span><span style="color:#b48ead">WORKDIR</span><span class="bash"> /app</span><span>
</span><span></span><span style="color:#b48ead">COPY</span><span class="bash"> . .</span><span>
</span><span></span><span style="color:#b48ead">COPY</span><span class="bash"> --from=deps /app/node_modules ./node_modules</span><span>
</span><span></span><span style="color:#b48ead">RUN</span><span class="bash"> yarn build &amp;&amp; yarn install --production --ignore-scripts --prefer-offline</span><span>
</span>
<span></span><span style="color:#65737e"># Production image, copy all the files and run next</span><span>
</span><span></span><span style="color:#b48ead">FROM</span><span> node:alpine AS runner
</span><span></span><span style="color:#b48ead">WORKDIR</span><span class="bash"> /app</span><span>
</span>
<span></span><span style="color:#b48ead">ENV</span><span> NODE_ENV production
</span>
<span></span><span style="color:#b48ead">RUN</span><span class="bash"> addgroup -g 1001 -S nodejs</span><span>
</span><span></span><span style="color:#b48ead">RUN</span><span class="bash"> adduser -S nextjs -u 1001</span><span>
</span>
<span></span><span style="color:#65737e"># You only need to copy next.config.js if you are NOT using the default configuration</span><span>
</span><span></span><span style="color:#65737e"># COPY --from=builder /app/next.config.js ./</span><span>
</span><span></span><span style="color:#b48ead">COPY</span><span class="bash"> --from=builder /app/public ./public</span><span>
</span><span></span><span style="color:#b48ead">COPY</span><span class="bash"> --from=builder --chown=nextjs:nodejs /app/.next ./.next</span><span>
</span><span></span><span style="color:#b48ead">COPY</span><span class="bash"> --from=builder /app/node_modules ./node_modules</span><span>
</span><span></span><span style="color:#b48ead">COPY</span><span class="bash"> --from=builder /app/package.json ./package.json</span><span>
</span>
<span></span><span style="color:#b48ead">USER</span><span> nextjs
</span>
<span></span><span style="color:#b48ead">EXPOSE</span><span> </span><span style="color:#d08770">3000</span><span>
</span>
<span></span><span style="color:#65737e"># Next.js collects completely anonymous telemetry data about general usage.</span><span>
</span><span></span><span style="color:#65737e"># Learn more here: https://nextjs.org/telemetry</span><span>
</span><span></span><span style="color:#65737e"># Uncomment the following line in case you want to disable telemetry.</span><span>
</span><span></span><span style="color:#65737e"># ENV NEXT_TELEMETRY_DISABLED 1</span><span>
</span>
<span></span><span style="color:#b48ead">CMD</span><span class="bash"> [</span><span class="bash" style="color:#a3be8c">&quot;yarn&quot;</span><span class="bash">, </span><span class="bash" style="color:#a3be8c">&quot;start&quot;</span><span class="bash">]</span><span>
</span></code></pre>
<h5>å¯¼å‡ºé™æ€æ–‡ä»¶</h5>
<p>æ‰§è¡Œ<code>next build</code> å’Œ <code>next export</code></p>
<p>ç¬¦åˆä»¥ä¸‹ä»»ä½•ä¸€é¡¹ï¼Œå°†ä¸å…è®¸ä½¿ç”¨é™æ€å¯¼å‡ºï¼š</p>
<ul>
<li>ä½¿ç”¨<code>getStaticPaths</code>çš„<code>fallback: true</code>æ¨¡å¼</li>
<li>ä½¿ç”¨äº†<code>next/Image</code>ç»„ä»¶ï¼Œå¹¶ä¸”ä½¿ç”¨é»˜è®¤</li>
<li>ä½¿ç”¨äº†<code>getServerSideProps</code>æ¥è·å–æ•°æ®</li>
<li>ä½¿ç”¨å›½é™…åŒ–è·¯ç”±</li>
<li>ä½¿ç”¨APIè·¯ç”±</li>
</ul></div><div class="content-container"></div></main><footer class="grid place-items-center pb-4"><a href="https://github.com/hmilin" target="_blank" rel="noreferrer noopener">ğŸ˜˜Github</a></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"source":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, {})\n  })) : _createMdxContent();\n  function _createMdxContent() {\n    const _components = Object.assign({\n      h1: \"h1\",\n      p: \"p\",\n      h3: \"h3\",\n      h4: \"h4\",\n      code: \"code\",\n      h5: \"h5\",\n      ul: \"ul\",\n      li: \"li\",\n      pre: \"pre\",\n      strong: \"strong\",\n      a: \"a\",\n      ol: \"ol\"\n    }, _provideComponents(), props.components);\n    return _jsxs(_Fragment, {\n      children: [_jsx(_components.h1, {\n        children: \"Next.js åŸºæœ¬ä½¿ç”¨\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"next.js æ˜¯åŸºäºReactçš„å‰ç«¯æ¡†æ¶ï¼Œä¸»è¦ç”¨äºæ”¯æŒé™æ€æ¸²æŸ“æˆ–æœåŠ¡ç«¯æ¸²æŸ“ã€‚\"\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"èƒŒæ™¯\"\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"SPA ğŸ’†\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"single-page applicationï¼Œå³å•é¡µé¢åº”ç”¨ï¼Œæ˜¯ä¸€ç§ç½‘ç»œåº”ç”¨ç¨‹åºæˆ–ç½‘ç«™çš„æ¨¡å‹ï¼Œå®ƒé€šè¿‡åŠ¨æ€é‡å†™å½“å‰é¡µé¢æ¥ä¸ç”¨æˆ·äº¤äº’ï¼Œé¿å…äº†é¡µé¢ä¹‹é—´åˆ‡æ¢æ‰“æ–­ç”¨æˆ·ä½“éªŒã€‚æ‰€æœ‰å¿…è¦çš„ä»£ç ï¼ˆ\", _jsx(_components.code, {\n          children: \"HTML\"\n        }), \"ã€\", _jsx(_components.code, {\n          children: \"JavaScript\"\n        }), \"å’Œ\", _jsx(_components.code, {\n          children: \"CSS\"\n        }), \"ï¼‰éƒ½é€šè¿‡å•ä¸ªé¡µé¢çš„åŠ è½½è€Œæ£€ç´¢ï¼Œæˆ–è€…æ ¹æ®éœ€è¦ï¼ˆé€šå¸¸æ˜¯ä¸ºå“åº”ç”¨æˆ·æ“ä½œï¼‰åŠ¨æ€è£…è½½é€‚å½“çš„èµ„æºå¹¶æ·»åŠ åˆ°é¡µé¢ï¼Œé¡µé¢åœ¨ä»»ä½•æ—¶é—´ç‚¹éƒ½ä¸ä¼šé‡æ–°åŠ è½½ï¼Œä¹Ÿä¸ä¼šå°†æ§åˆ¶è½¬ç§»åˆ°å…¶ä»–é¡µé¢ã€‚\"]\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"ä¼˜ç¼ºç‚¹\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"ä¼˜ç‚¹ï¼š\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"ç”¨æˆ·ä½“éªŒå¥½ï¼Œé¡µé¢åˆ‡æ¢é€Ÿåº¦å¿«\"\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"è‰¯å¥½çš„å‰åç«¯åˆ†ç¦»ï¼Œåˆ†å·¥æ˜ç¡®\"\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"ç¼ºç‚¹ï¼š\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"ä¸åˆ©äºSEO\"\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"é¦–å±æ¸²æŸ“é€Ÿåº¦è¾ƒæ…¢\"\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"CSR å’Œ SSR\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"CSRï¼šClient Side Renderï¼Œå³å®¢æˆ·ç«¯æ¸²æŸ“ï¼ŒæœåŠ¡ç«¯åªè¿”å›ä¸€ä¸ªhtmlæ¨¡æ¿ï¼Œé¡µé¢çš„å†…å®¹é€šè¿‡è¿è¡Œjsè¿è¡Œã€‚Angularã€Reactå’ŒVueæ„å»ºçš„åº”ç”¨ï¼Œé»˜è®¤éƒ½æ˜¯å®¢æˆ·ç«¯æ¸²æŸ“ã€‚\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"SSRï¼šServer Side Renderï¼Œå³æœåŠ¡ç«¯æ¸²æŸ“ã€‚é¡µé¢ä¸Šçš„å†…å®¹é€šè¿‡æœåŠ¡ç«¯æ¸²æŸ“ç”Ÿæˆï¼Œç„¶åå†å°†å®Œæ•´çš„htmlè¿”å›ç»™æµè§ˆå™¨ã€‚\"\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"å¿«é€Ÿå¼€å§‹\"\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"åˆ›å»ºé¡¹ç›®\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"ä½¿ç”¨\", _jsx(_components.code, {\n          children: \"create-next-app\"\n        }), \"åˆ›å»ºæ–°çš„ Next.js åº”ç”¨ç¨‹åº\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-bash\",\n          children: \"npx create-next-app --typescript\\n# or\\nyarn create next-app --typescript\\n\"\n        })\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"åŸºæœ¬ç‰¹æ€§\"\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"é¡µé¢\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"åœ¨ Next.js ä¸­ï¼Œä¸€ä¸ª \", _jsx(_components.strong, {\n          children: \"pageï¼ˆé¡µé¢ï¼‰\"\n        }), \" å°±æ˜¯ä¸€ä¸ªä» \", _jsx(_components.code, {\n          children: \".js\"\n        }), \"ã€\", _jsx(_components.code, {\n          children: \"jsx\"\n        }), \"ã€\", _jsx(_components.code, {\n          children: \".ts\"\n        }), \" æˆ– \", _jsx(_components.code, {\n          children: \".tsx\"\n        }), \" æ–‡ä»¶å¯¼å‡ºï¼ˆexportï¼‰çš„ \", _jsx(_components.a, {\n          href: \"https://reactjs.org/docs/components-and-props.html\",\n          children: \"React ç»„ä»¶\"\n        }), \" ï¼Œè¿™äº›æ–‡ä»¶å­˜æ”¾åœ¨ \", _jsx(_components.code, {\n          children: \"pages\"\n        }), \" ç›®å½•ä¸‹ã€‚æ¯ä¸ª pageï¼ˆé¡µé¢ï¼‰éƒ½ä½¿ç”¨å…¶æ–‡ä»¶åä½œä¸ºè·¯ç”±ï¼ˆrouteï¼‰ã€‚\"]\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"è·¯ç”±\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"â€‹\\tæ–‡ä»¶ç›®å½• â†’ è·¯ç”±\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"pages/index.js\"\n          }), \"  â†’ \", _jsx(_components.code, {\n            children: \"/\"\n          })]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"pages/blog/index.js\"\n          }), \" â†’ \", _jsx(_components.code, {\n            children: \"/blog\"\n          })]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"pages/blog.js\"\n          }), \"â†’ \", _jsx(_components.code, {\n            children: \"/blog\"\n          })]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"pages/blog/[id].js\"\n          }), \"â†’ \", _jsx(_components.code, {\n            children: \"/blog/:id\"\n          })]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"pages/[username]/settings.js\"\n          }), \" â†’ \", _jsx(_components.code, {\n            children: \"/:username/settings\"\n          })]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.code, {\n            children: \"pages/post/[...all].js\"\n          }), \" â†’ \", _jsx(_components.code, {\n            children: \"/post/*\"\n          }), \" (\", _jsx(_components.code, {\n            children: \"/post/2020/id/title\"\n          }), \")\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"é€šè¿‡useRouterè·å–åŠ¨æ€å‚æ•°ï¼Œå¦‚ä¸‹ï¼š\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-tsx\",\n          children: \"const router = useRouter();\\nconst { all } = router.query;\\n\"\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"è·¯ç”±è·³è½¬æœ‰ä¸¤ç§æ–¹å¼ï¼Œé€šè¿‡Linkç»„ä»¶æˆ–è€…useRouter\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-tsx\",\n          children: \"import Link from 'next/link'\\n\\nconst Post: NextPage = () =\u003e {\\n    ...\\n    return (\\n        \u003cdiv\u003e\\n            \u003cp\u003e{Array.isArray(all) ? all.join('/') : all}\u003c/p\u003e\\n            \u003cLink href=\\\"/blog/123\\\"\u003e\u003ca\u003eblog\u003c/a\u003e\u003c/Link\u003e\\n        \u003c/div\u003e\\n    );\\n}\\n\\n\"\n        })\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"è·å–æ•°æ®\"\n      }), \"\\n\", _jsxs(_components.ol, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"getStaticProps\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"ä½¿ç”¨getStaticPropsæ–¹æ³•ï¼Œnext.jsä¼šåœ¨æ‰§è¡Œ\", _jsx(_components.code, {\n          children: \"next-build\"\n        }), \"çš„æ—¶å€™é¢„æ¸²æŸ“é¡µé¢ï¼Œå¹¶å°†getStaticPropsçš„è¿”å›ä½œä¸ºpropsä¼ ç»™ç»„ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰§è¡Œå®Œbuildä¹‹åï¼Œæ•°æ®å°±å˜æˆé™æ€çš„æ•°æ®äº†ã€‚\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-tsx\",\n          children: \"export async function getStaticProps(context) {\\n    const res = await fetch(`https://service-go08i9b4-1301241041.gz.apigw.tencentcs.com/products`);\\n    const products = await res.json();\\n\\n    if (!products) {\\n        return {\\n            notFound: true,\\n        }\\n    }\\n\\n    return {\\n        props: { products: products as Products }, // will be passed to the page component as props\\n    }\\n}\\n\"\n        })\n      }), \"\\n\", _jsxs(_components.ol, {\n        start: \"2\",\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"getServerSideProps\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"ä½¿ç”¨getServerSidePropsæ–¹æ³•ï¼Œnext.jsä¼šåœ¨æ¯ä¸€æ¬¡è¯·æ±‚çš„æ—¶å€™å°†è¿”å›ç»“æœä½œä¸ºpropsä¼ ç»™ç»„ä»¶ã€‚ä½¿ç”¨getServerSidePropsæ¥è·å–æ•°æ®ï¼Œè™½ç„¶å‰§æœ‰å®æ—¶æ€§ï¼Œä½†æ˜¯å“åº”é€Ÿåº¦å°†æ¯”getStaticPropsæ…¢ï¼Œå› ä¸ºæ¯ä¸€æ¬¡éƒ½éœ€è¦è¯·æ±‚æ–°çš„æ•°æ®ç„¶åè®¡ç®—ç»“æœï¼Œå¹¶ä¸”ä¸èƒ½åœ¨æ²¡æœ‰é¢å¤–çš„é…ç½®ä¸‹è¢«CDNç¼“å­˜ã€‚\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-js\",\n          children: \"function Page({ data }) {\\n  // Render data...\\n}\\n\\n// This gets called on every request\\nexport async function getServerSideProps() {\\n  // Fetch data from external API\\n  const res = await fetch(`https://.../data`)\\n  const data = await res.json()\\n\\n  // Pass data to the page via props\\n  return { props: { data } }\\n}\\n\\nexport default Page\\n\"\n        })\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"CSSæ”¯æŒ\"\n      }), \"\\n\", _jsxs(_components.ol, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"å…¨å±€æ ·å¼\"\n          }), \"\\n\", _jsxs(_components.p, {\n            children: [\"åœ¨\", _jsx(_components.code, {\n              children: \"pages/_app.tsx\"\n            }), \"ä¸­å¯¼å…¥cssæ–‡ä»¶ï¼ŒåŒæ ·æ”¯æŒä»\", _jsx(_components.code, {\n              children: \"node_modules\"\n            }), \"ç›®å½•å¯¼å…¥ã€‚\"]\n          }), \"\\n\", _jsx(_components.pre, {\n            children: _jsx(_components.code, {\n              className: \"language-tsx\",\n              children: \"import '../styles/globals.css'\\nimport 'bootstrap/dist/css/bootstrap.css'\\n\"\n            })\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: \"ç»„ä»¶æ ·å¼\"\n          }), \"\\n\", _jsxs(_components.p, {\n            children: [\"Next.js é€šè¿‡ \", _jsx(_components.code, {\n              children: \"[name].module.css\"\n            }), \" æ–‡ä»¶å‘½åçº¦å®šæ¥æ”¯æŒ \", _jsx(_components.a, {\n              href: \"https://github.com/css-modules/css-modules\",\n              children: \"CSS æ¨¡å—\"\n            }), \" ã€‚\"]\n          }), \"\\n\", _jsxs(_components.p, {\n            children: [\"ä¾‹å¦‚ï¼Œå‡è®¾ \", _jsx(_components.code, {\n              children: \"components/\"\n            }), \" ç›®å½•ä¸‹æœ‰ä¸€ä¸ªå¯é‡ç”¨ \", _jsx(_components.code, {\n              children: \"Button\"\n            }), \" ç»„ä»¶ï¼š\"]\n          }), \"\\n\", _jsxs(_components.p, {\n            children: [\"é¦–å…ˆï¼Œåˆ›å»º \", _jsx(_components.code, {\n              children: \"components/Button.module.css\"\n            }), \" æ–‡ä»¶å¹¶å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼š\"]\n          }), \"\\n\", _jsx(_components.pre, {\n            children: _jsx(_components.code, {\n              className: \"language-css\",\n              children: \".error {\\n  color: white;\\n  background-color: red;\\n}\\n\"\n            })\n          }), \"\\n\", _jsxs(_components.p, {\n            children: [\"ç„¶åï¼Œåˆ›å»º \", _jsx(_components.code, {\n              children: \"components/Button.js\"\n            }), \" æ–‡ä»¶ï¼Œå¯¼å…¥ï¼ˆimportï¼‰å¹¶ä½¿ç”¨ä¸Šè¿° CSS æ–‡ä»¶ï¼š\"]\n          }), \"\\n\", _jsx(_components.pre, {\n            children: _jsx(_components.code, {\n              className: \"language-js\",\n              children: \"import styles from './Button.module.css'\\n\\nexport function Button() {\\n  return (\\n    \u003cbutton\\n      type=\\\"button\\\"\\n      // Note how the \\\"error\\\" class is accessed as a property on the imported\\n      // `styles` object.\\n      className={styles.error}\\n    \u003e\\n      Destroy\\n    \u003c/button\u003e\\n  )\\n}\\n\"\n            })\n          }), \"\\n\", _jsxs(_components.p, {\n            children: [\"å¦å¤–ï¼ŒNext.jså…è®¸å¯¼å…¥ï¼ˆimportï¼‰å…·æœ‰ \", _jsx(_components.code, {\n              children: \".scss\"\n            }), \" å’Œ \", _jsx(_components.code, {\n              children: \".sass\"\n            }), \" æ‰©å±•åçš„ Sass æ–‡ä»¶ï¼Œåªè¦ç¡®ä¿å®‰è£…äº†sassï¼Œå³å¯ä½¿ç”¨ã€‚\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"å¸¸ç”¨ç»„ä»¶\"\n      }), \"\\n\", _jsxs(_components.ol, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: _jsx(_components.code, {\n              children: \"next/image\"\n            })\n          }), \"\\n\", _jsxs(_components.p, {\n            children: [\"Next.js çš„ Image ç»„ä»¶ï¼ˆå³ \", _jsx(_components.a, {\n              href: \"https://www.nextjs.cn/docs/api-reference/next/image\",\n              children: _jsx(_components.code, {\n                children: \"next/image\"\n              })\n            }), \"ï¼‰æ˜¯å¯¹ HTML çš„ \", _jsx(_components.code, {\n              children: \"\u003cimg\u003e\"\n            }), \" å…ƒç´ çš„æ‰©å±•ï¼Œè·Ÿè¿›äº†æœ€æ–°çš„ web æŠ€æœ¯ã€‚\"]\n          }), \"\\n\", _jsxs(_components.p, {\n            children: [\"è‡ªåŠ¨å›¾ç‰‡ä¼˜åŒ–åŠŸèƒ½ï¼ˆAutomatic Image Optimizationï¼‰èƒ½å¤Ÿè°ƒæ•´å›¾ç‰‡å°ºå¯¸ã€ä¼˜åŒ–å›¾ç‰‡å¹¶ä»¥æœ€æ–°çš„ \", _jsx(_components.a, {\n              href: \"https://developer.mozilla.org/en-US/docs/Web/Media/Formats/Image_types\",\n              children: \"WebP\"\n            }), \" æ ¼å¼ä¼ è¾“å›¾ç‰‡ï¼ˆå¦‚æœæµè§ˆå™¨æ”¯æŒ WebP æ ¼å¼çš„è¯ï¼‰ã€‚è¿™æ ·å°±å¯ä»¥é¿å…å°†è¾ƒå¤§çš„å›¾ç‰‡ä¼ é€åˆ°è§†å£ï¼ˆviewportï¼‰è¾ƒå°çš„è®¾å¤‡ä¸Šã€‚æ­¤åŠŸèƒ½è¿˜å…è®¸ Next.js è‡ªåŠ¨é‡‡ç”¨æœªæ¥çš„å›¾ç‰‡æ ¼å¼ï¼Œå¹¶å°†å…¶ä¼ è¾“ç»™æ”¯æŒè¿™äº›æ ¼å¼çš„æµè§ˆå™¨ã€‚\"]\n          }), \"\\n\", _jsx(_components.p, {\n            children: \"è‡ªåŠ¨å›¾ç‰‡ä¼˜åŒ–åŠŸèƒ½å¯ä»¥æ”¯æŒä»»ä½•å›¾ç‰‡æ¥æºã€‚å³ä½¿æ˜¯æ‰˜ç®¡åœ¨å¤–éƒ¨æ•°æ®æºä¸Šï¼ˆä¾‹å¦‚ï¼ŒCMSï¼‰ï¼Œä»å¯å¯¹å›¾ç‰‡è¿›è¡Œä¼˜åŒ–ã€‚\"\n          }), \"\\n\", _jsx(_components.p, {\n            children: \"Next.js æ— éœ€åœ¨æ„å»ºæ—¶ä¼˜åŒ–å›¾ç‰‡ï¼Œè€Œæ˜¯æ ¹æ®ç”¨æˆ·çš„è¯·æ±‚æŒ‰éœ€ä¼˜åŒ–å›¾ç‰‡ã€‚ä¸é™æ€ç«™ç‚¹ç”Ÿæˆå™¨å’Œçº¯é™æ€è§£å†³æ–¹æ¡ˆä¸åŒï¼Œæ— è®ºå‘å¸ƒ 10 å¼ è¿˜æ˜¯ 1000 ä¸‡å¼ å›¾ç‰‡ï¼Œæ„å»ºæ—¶é—´éƒ½ä¸ä¼šå¢åŠ ã€‚\"\n          }), \"\\n\", _jsx(_components.p, {\n            children: \"å›¾ç‰‡é»˜è®¤æ˜¯å»¶è¿ŸåŠ è½½çš„ã€‚è¿™æ„å‘³ç€ä½ çš„é¡µé¢ä¸ä¼šå› ä¸ºåŠ è½½è§†å£ï¼ˆviewportï¼‰å¤–çš„å›¾ç‰‡è€Œå½±å“é¡µé¢çš„åŠ è½½é€Ÿåº¦ã€‚å½“å›¾ç‰‡è¿›å…¥è§†å£ï¼ˆviewportï¼‰æ—¶æ‰åŠ è½½ã€‚\"\n          }), \"\\n\", _jsxs(_components.p, {\n            children: [\"å§‹ç»ˆä»¥è¿™ç§æ–¹å¼æ¸²æŸ“å›¾ç‰‡æ˜¯ä¸ºäº†é¿å… \", _jsx(_components.a, {\n              href: \"https://web.dev/cls/\",\n              children: \"ç´¯è®¡å¸ƒå±€åç§»ï¼ˆCumulative Layout Shiftï¼‰\"\n            }), \"ï¼Œæ­¤ \", _jsx(_components.a, {\n              href: \"https://web.dev/vitals/\",\n              children: \"Core Web Vital\"\n            }), \" è¢« Google ä½œä¸ºå‚æ•°ç”¨äº \", _jsx(_components.a, {\n              href: \"https://webmasters.googleblog.com/2020/05/evaluating-page-experience.html\",\n              children: \"æœç´¢æ’å\"\n            }), \"ã€‚\"]\n          }), \"\\n\", _jsx(_components.p, {\n            children: \"ä½¿ç”¨ï¼š\"\n          }), \"\\n\", _jsx(_components.pre, {\n            children: _jsx(_components.code, {\n              className: \"language-jsx\",\n              children: \"import Image from 'next/image'\\n\\nfunction Home() {\\n  return (\\n    \u003c\u003e\\n      \u003ch1\u003eMy Homepage\u003c/h1\u003e\\n      \u003cImage\\n        src=\\\"/me.png\\\"\\n        alt=\\\"Picture of the author\\\"\\n        width={500}\\n        height={500}\\n      /\u003e\\n      \u003cp\u003eWelcome to my homepage!\u003c/p\u003e\\n    \u003c/\u003e\\n  )\\n}\\n\\nexport default Home\\n\"\n            })\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: _jsx(_components.code, {\n              children: \"next/head\"\n            })\n          }), \"\\n\", _jsxs(_components.p, {\n            children: [\"ç”¨äºå°† HTML æ ‡ç­¾æ·»åŠ åˆ°é¡µé¢çš„ \", _jsx(_components.code, {\n              children: \"head\"\n            }), \" ä¸­\"]\n          }), \"\\n\", _jsx(_components.pre, {\n            children: _jsx(_components.code, {\n              className: \"language-js\",\n              children: \"import Head from 'next/head'\\n\\nfunction IndexPage() {\\n  return (\\n    \u003cdiv\u003e\\n      \u003cHead\u003e\\n        \u003ctitle\u003eMy page title\u003c/title\u003e\\n        \u003cmeta name=\\\"viewport\\\" content=\\\"initial-scale=1.0, width=device-width\\\" /\u003e\\n      \u003c/Head\u003e\\n      \u003cp\u003eHello world!\u003c/p\u003e\\n    \u003c/div\u003e\\n  )\\n}\\n\\nexport default IndexPage\\n\"\n            })\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"é…ç½®\"\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"ç®€ä»‹\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"å¯¹äº Next.js çš„è‡ªå®šä¹‰é«˜çº§è¡Œä¸ºï¼Œå¯ä»¥åœ¨é¡¹ç›®ç›®å½•çš„æ ¹ç›®å½•ï¼ˆpackage.json æ—è¾¹ï¼‰åˆ›å»ºä¸€ä¸ª next.config.jsã€‚\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.code, {\n          children: \"next.config.js\"\n        }), \"æ˜¯ä¸€ä¸ªNode.jsæ¨¡å—ï¼Œä¸æ˜¯ä¸€ä¸ªjsonæ–‡ä»¶ã€‚\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"å®šä¹‰å¦‚ä¸‹ï¼š\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-js\",\n          children: \"module.exports = {\\n  /* config options here */\\n}\\n\"\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼š\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-js\",\n          children: \"module.exports = (phase, { defaultConfig }) =\u003e {\\n  return {\\n    /* config options here */\\n  }\\n}\\n\"\n        })\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"é€šè¿‡configçš„ç±»å‹å¤§æ¦‚å¯ä»¥çŸ¥é“å®ƒæ”¯æŒå“ªäº›é…ç½®ï¼š\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-typescript\",\n          children: \"export declare type NextConfig = {\\n    [key: string]: any;\\n} \u0026 {\\n    i18n?: I18NConfig | null;\\n    eslint?: ESLintConfig;\\n    typescript?: TypeScriptConfig;\\n    headers?: () =\u003e Promise\u003cHeader[]\u003e;\\n    rewrites?: () =\u003e Promise\u003cRewrite[] | {\\n        beforeFiles: Rewrite[];\\n        afterFiles: Rewrite[];\\n        fallback: Rewrite[];\\n    }\u003e;\\n    redirects?: () =\u003e Promise\u003cRedirect[]\u003e;\\n    webpack5?: false;\\n    excludeDefaultMomentLocales?: boolean;\\n    webpack?: ((config: any, context: {\\n        dir: string;\\n        dev: boolean;\\n        isServer: boolean;\\n        buildId: string;\\n        config: NextConfigComplete;\\n        defaultLoaders: {\\n            babel: any;\\n        };\\n        totalPages: number;\\n        webpack: any;\\n    }) =\u003e any) | null;\\n    trailingSlash?: boolean;\\n    env?: {\\n        [key: string]: string;\\n    };\\n    distDir?: string;\\n    cleanDistDir?: boolean;\\n    assetPrefix?: string;\\n    useFileSystemPublicRoutes?: boolean;\\n    generateBuildId?: () =\u003e string | null | Promise\u003cstring | null\u003e;\\n    generateEtags?: boolean;\\n    pageExtensions?: string[];\\n    compress?: boolean;\\n    poweredByHeader?: boolean;\\n    images?: ImageConfig;\\n    devIndicators?: {\\n        buildActivity?: boolean;\\n    };\\n    onDemandEntries?: {\\n        maxInactiveAge?: number;\\n        pagesBufferLength?: number;\\n    };\\n    amp?: {\\n        canonicalBase?: string;\\n    };\\n    basePath?: string;\\n    sassOptions?: {\\n        [key: string]: any;\\n    };\\n    productionBrowserSourceMaps?: boolean;\\n    optimizeFonts?: boolean;\\n    reactStrictMode?: boolean;\\n    publicRuntimeConfig?: {\\n        [key: string]: any;\\n    };\\n    serverRuntimeConfig?: {\\n        [key: string]: any;\\n    };\\n    httpAgentOptions?: {\\n        keepAlive?: boolean;\\n    };\\n    future?: {\\n        /**\\n         * @deprecated this options was moved to the top level\\n         */\\n        webpack5?: false;\\n        strictPostcssConfiguration?: boolean;\\n    };\\n    experimental?: {\\n        swcMinify?: boolean;\\n        swcLoader?: boolean;\\n        cpus?: number;\\n        sharedPool?: boolean;\\n        plugins?: boolean;\\n        profiling?: boolean;\\n        isrFlushToDisk?: boolean;\\n        reactMode?: 'legacy' | 'concurrent' | 'blocking';\\n        workerThreads?: boolean;\\n        pageEnv?: boolean;\\n        optimizeImages?: boolean;\\n        optimizeCss?: boolean;\\n        scrollRestoration?: boolean;\\n        stats?: boolean;\\n        externalDir?: boolean;\\n        conformance?: boolean;\\n        amp?: {\\n            optimizer?: any;\\n            validator?: string;\\n            skipValidation?: boolean;\\n        };\\n        reactRoot?: boolean;\\n        disableOptimizedLoading?: boolean;\\n        gzipSize?: boolean;\\n        craCompat?: boolean;\\n        esmExternals?: boolean | 'loose';\\n        staticPageGenerationTimeout?: number;\\n        isrMemoryCacheSize?: number;\\n        nftTracing?: boolean;\\n        concurrentFeatures?: boolean;\\n    };\\n};\\n\"\n        })\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"éƒ¨ç½²\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"nextçš„éƒ¨ç½²ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼\"\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"Vercel\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Vercel (ä¹‹å‰ä¹Ÿå« Zeit æˆ– now.sh) æ˜¯ä¸€å®¶æä¾›é™æ€ç½‘ç«™æ‰˜ç®¡çš„äº‘å¹³å°ï¼Œæ”¯æŒä» Github, GitLab, Bitbucket ç­‰ä»£ç ä»“åº“ä¸­è‡ªåŠ¨æ‹‰å–ä»£ç  ç„¶åè¿›è¡Œé¡¹ç›®æ‰“åŒ…å’Œéƒ¨ç½²ç­‰åŠŸèƒ½ã€‚ä½†æ˜¯å›½å†…è®¿é—®é€Ÿåº¦è¾ƒæ…¢ï¼Œåœ¨æ­¤ä¸å¤šåšä»‹ç»ã€‚\"\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"Node.jsæœåŠ¡\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Next.js å¯ä»¥éƒ¨ç½²åˆ°ä»»ä½•æ”¯æŒ Node.js çš„æ‰˜ç®¡æä¾›å•†å¤„ã€‚\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"ç¡®ä¿ä½ çš„ \", _jsx(_components.code, {\n          children: \"package.json\"\n        }), \" æ–‡ä»¶ä¸­è®¾ç½®äº† \", _jsx(_components.code, {\n          children: \"\\\"build\\\"\"\n        }), \" å’Œ \", _jsx(_components.code, {\n          children: \"\\\"start\\\"\"\n        }), \" è„šæœ¬ï¼š\"]\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-json\",\n          children: \"{\\n  \\\"scripts\\\": {\\n    \\\"dev\\\": \\\"next\\\",\\n    \\\"build\\\": \\\"next build\\\",\\n    \\\"start\\\": \\\"next start\\\"\\n  }\\n}\\n\"\n        })\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"Docker Image\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"æ‰“æˆé•œåƒï¼Œå¯ä»¥éƒ¨ç½²åˆ°dockerå®¹å™¨é‡Œï¼Œä¹Ÿå¯ä»¥éƒ¨ç½²åˆ°å®¹å™¨ç¼–æ’å™¨é‡Œï¼ˆkubernetesæˆ–è€…HashiCorp Nomadï¼‰ã€‚\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Dockerfileæ–‡ä»¶å‚è€ƒï¼š\"\n      }), \"\\n\", _jsx(_components.pre, {\n        children: _jsx(_components.code, {\n          className: \"language-dockerfile\",\n          children: \"# Install dependencies only when needed\\nFROM node:alpine AS deps\\n# Check https://github.com/nodejs/docker-node/tree/b4117f9333da4138b03a546ec926ef50a31506c3#nodealpine to understand why libc6-compat might be needed.\\nRUN apk add --no-cache libc6-compat\\nWORKDIR /app\\nCOPY package.json yarn.lock ./\\nRUN yarn install --frozen-lockfile\\n\\n# Rebuild the source code only when needed\\nFROM node:alpine AS builder\\nWORKDIR /app\\nCOPY . .\\nCOPY --from=deps /app/node_modules ./node_modules\\nRUN yarn build \u0026\u0026 yarn install --production --ignore-scripts --prefer-offline\\n\\n# Production image, copy all the files and run next\\nFROM node:alpine AS runner\\nWORKDIR /app\\n\\nENV NODE_ENV production\\n\\nRUN addgroup -g 1001 -S nodejs\\nRUN adduser -S nextjs -u 1001\\n\\n# You only need to copy next.config.js if you are NOT using the default configuration\\n# COPY --from=builder /app/next.config.js ./\\nCOPY --from=builder /app/public ./public\\nCOPY --from=builder --chown=nextjs:nodejs /app/.next ./.next\\nCOPY --from=builder /app/node_modules ./node_modules\\nCOPY --from=builder /app/package.json ./package.json\\n\\nUSER nextjs\\n\\nEXPOSE 3000\\n\\n# Next.js collects completely anonymous telemetry data about general usage.\\n# Learn more here: https://nextjs.org/telemetry\\n# Uncomment the following line in case you want to disable telemetry.\\n# ENV NEXT_TELEMETRY_DISABLED 1\\n\\nCMD [\\\"yarn\\\", \\\"start\\\"]\\n\"\n        })\n      }), \"\\n\", _jsx(_components.h5, {\n        children: \"å¯¼å‡ºé™æ€æ–‡ä»¶\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"æ‰§è¡Œ\", _jsx(_components.code, {\n          children: \"next build\"\n        }), \" å’Œ \", _jsx(_components.code, {\n          children: \"next export\"\n        })]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"ç¬¦åˆä»¥ä¸‹ä»»ä½•ä¸€é¡¹ï¼Œå°†ä¸å…è®¸ä½¿ç”¨é™æ€å¯¼å‡ºï¼š\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"ä½¿ç”¨\", _jsx(_components.code, {\n            children: \"getStaticPaths\"\n          }), \"çš„\", _jsx(_components.code, {\n            children: \"fallback: true\"\n          }), \"æ¨¡å¼\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"ä½¿ç”¨äº†\", _jsx(_components.code, {\n            children: \"next/Image\"\n          }), \"ç»„ä»¶ï¼Œå¹¶ä¸”ä½¿ç”¨é»˜è®¤\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"ä½¿ç”¨äº†\", _jsx(_components.code, {\n            children: \"getServerSideProps\"\n          }), \"æ¥è·å–æ•°æ®\"]\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"ä½¿ç”¨å›½é™…åŒ–è·¯ç”±\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"ä½¿ç”¨APIè·¯ç”±\"\n        }), \"\\n\"]\n      })]\n    });\n  }\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{"title":"Next.js åŸºæœ¬ä½¿ç”¨","date":"2021-09-09 20:23:00","description":"Next.js ä»æ­å»ºåˆ°éƒ¨ç½²"}},"frontMatter":{"title":"Next.js åŸºæœ¬ä½¿ç”¨","date":"2021-09-09 20:23:00","description":"Next.js ä»æ­å»ºåˆ°éƒ¨ç½²"}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"next"},"buildId":"uLUvI9Sb-fn169cVF0wll","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>